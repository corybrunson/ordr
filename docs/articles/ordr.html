<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Ordination in the tidyverse • ordr</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ordination in the tidyverse">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ordr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/ordr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/cmds-variables.html">multidimensional scaling of variables</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/corybrunson/ordr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Ordination in the tidyverse</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/corybrunson/ordr/blob/HEAD/vignettes/ordr.rmd" class="external-link"><code>vignettes/ordr.rmd</code></a></small>
      <div class="d-none name"><code>ordr.rmd</code></div>
    </div>

    
    
<p>This vignette introduces the goals and functionality of the
<strong>ordr</strong> package. Users should have some familiarity with
the class of <em>ordination</em> models powered by singular value
decomposition, such as principal components analysis, correspondence
analysis, and linear discriminant analysis, and with the <em>biplot</em>
statistical graphic used to visualize these models. Users should also be
familiar with the <strong>tidyverse</strong> R package collection for
data science and parts of the <strong>tidymodels</strong> collection for
statistical modeling, most notably <strong>tibble</strong>,
<strong>dplyr</strong>, <strong>broom</strong>, and
<strong>ggplot2</strong>.</p>
<p>Briefly, <strong>ordr</strong> incorporates ordination models into a
“tidy” workflow. Specifically, for fitted ordination models of a variety
of classes, users can</p>
<ul>
<li>augment the model with row- or column-level diagnostics and
annotations,</li>
<li>summarize the model or its components as tidy data frames, and</li>
<li>produce biplots of the model using a layered grammar of
graphics.</li>
</ul>
<p>As an example, this vignette performs a correspondence analysis (CA)
of the <code>HairEyeColor</code> data set installed with R, using the
fitting engine <code><a href="https://rdrr.io/pkg/MASS/man/corresp.html" class="external-link">corresp()</a></code> provided by the
<strong>MASS</strong> package and its base plotting methods, then
showcases the more flexible and elegant methods provided by
<strong>ordr</strong>. While some techniques specific to CA are not as
natural in <strong>ordr</strong>, most can be reproduced through the
principled use of general steps.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">HairEyeColor</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/corybrunson/ordr" class="external-link">ordr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span></code></pre></div>
<div class="section level2">
<h2 id="the-hair-and-eye-color-data">the hair and eye color data<a class="anchor" aria-label="anchor" href="#the-hair-and-eye-color-data"></a>
</h2>
<p>We begin with an inspection of the data using base R. For more
information about the data set, call
<code><a href="https://rdrr.io/r/datasets/HairEyeColor.html" class="external-link">help(HairEyeColor)</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">HairEyeColor</span><span class="op">)</span></span>
<span><span class="co">#&gt; , , Sex = Male</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel Green</span></span>
<span><span class="co">#&gt;   Black    32   11    10     3</span></span>
<span><span class="co">#&gt;   Brown    53   50    25    15</span></span>
<span><span class="co">#&gt;   Red      10   10     7     7</span></span>
<span><span class="co">#&gt;   Blond     3   30     5     8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , Sex = Female</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel Green</span></span>
<span><span class="co">#&gt;   Black    36    9     5     2</span></span>
<span><span class="co">#&gt;   Brown    66   34    29    14</span></span>
<span><span class="co">#&gt;   Red      16    7     7     7</span></span>
<span><span class="co">#&gt;   Blond     4   64     5     8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">HairEyeColor</span><span class="op">)</span></span></code></pre></div>
<p><img src="ordr_files/figure-html/unnamed-chunk-1-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The data were collected by students in one of Ronald Snee’s
statistics courses.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Snee RD (1974) “Graphical Display of Two-way Contingency
Tables”. &lt;em&gt;The American Statistician&lt;/em&gt; &lt;strong&gt;28&lt;/strong&gt;(1),
9-12. &lt;a href="https://www.tandfonline.com/doi/abs/10.1080/00031305.1974.10479053" class="external-link uri"&gt;https://www.tandfonline.com/doi/abs/10.1080/00031305.1974.10479053&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a> They consist of the hair color and eye
color, each binned into four groups, of 592 subjects. The data are also
stratified by sex, forming a 3-way array. The (default) mosaic plot
reveals only subtle differences by sex, so we lose little by flattening
the array into a <span class="math inline">\(4 \times 4\)</span> matrix.
The resulting count table is suitable for correspondence analysis, and
we fit this model next.</p>
</div>
<div class="section level2">
<h2 id="correspondence-analysis-using-mass">correspondence analysis using <strong>MASS</strong><a class="anchor" aria-label="anchor" href="#correspondence-analysis-using-mass"></a>
</h2>
<p>The implementation <code><a href="https://rdrr.io/pkg/MASS/man/corresp.html" class="external-link">MASS::corresp()</a></code> returns an object of
class ‘correspondence’. In addition to the information included in its
<code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> method, we can use the canonical correlations to
calculate the proportion of variance along each dimension:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">haireye</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">HairEyeColor</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span></span>
<span><span class="va">haireye_ca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/corresp.html" class="external-link">corresp</a></span><span class="op">(</span><span class="va">haireye</span>, nf <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">haireye_ca</span><span class="op">)</span></span>
<span><span class="co">#&gt; First canonical correlation(s): 0.45691646 0.14908593 0.05097489 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Hair scores:</span></span>
<span><span class="co">#&gt;             [,1]       [,2]       [,3]</span></span>
<span><span class="co">#&gt; Black -1.1042772  1.4409170 -1.0889497</span></span>
<span><span class="co">#&gt; Brown -0.3244635 -0.2191109  0.9574152</span></span>
<span><span class="co">#&gt; Red   -0.2834725 -2.1440145 -1.6312184</span></span>
<span><span class="co">#&gt; Blond  1.8282287  0.4667063 -0.3180920</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Eye scores:</span></span>
<span><span class="co">#&gt;             [,1]       [,2]        [,3]</span></span>
<span><span class="co">#&gt; Brown -1.0771283  0.5924202 -0.42395984</span></span>
<span><span class="co">#&gt; Blue   1.1980612  0.5564193  0.09238682</span></span>
<span><span class="co">#&gt; Hazel -0.4652862 -1.1227826  1.97191769</span></span>
<span><span class="co">#&gt; Green  0.3540108 -2.2741218 -1.71844295</span></span>
<span><span class="co"># proportion of variance in each dimension</span></span>
<span><span class="va">haireye_ca</span><span class="op">$</span><span class="va">cor</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">haireye_ca</span><span class="op">$</span><span class="va">cor</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.89372732 0.09514911 0.01112356</span></span></code></pre></div>
<p>The variation in the table, in terms of the <span class="math inline">\(\chi^2\)</span> distances between the
distributions of hair color among people with the same eye color (or,
equivalently, vice-versa), lies largely (<span class="math inline">\(89\%\)</span>) along a single dimension, with the
remaining variation largely (<span class="math inline">\(9.5\%\)</span>)
along a single orthogonal dimension. The first dimension best
distinguishes between subjects with black hair and brown eyes from those
with blond hair and blue eyes. Subjects with brown and red hair, or with
hazel and green eyes, lie between these extremes.</p>
<p>The second dimension distinguishes subjects with black or blond hair,
and with brown or blue eyes, from those with brown or red hair, and with
hazel or green eyes. Subjects with red hair and green eyes are
especially distinguished along this dimension. This disrupts the
impression from the first dimension alone that subjects lie along a
spectrum from black hair–brown eyes to blond hair–blue eyes, which may
accurately include an intermediate phenotype (brown hair–hazel eyes),
and reveals a phenotype (red hair–green eyes) that diverges from this
spectrum.</p>
<p>As an exercise, we can recover the row and column standard
coordinates returned by <code><a href="https://rdrr.io/pkg/MASS/man/corresp.html" class="external-link">corresp()</a></code> from direct computations,
e.g. following <a href="https://en.wikipedia.org/wiki/Correspondence_analysis" class="external-link">the
Wikipedia article on correspondence analysis</a>, starting from the data
matrix (count table) <span class="math inline">\(X\)</span> with total
count <span class="math inline">\(n = 1^\top X 1\)</span>:</p>
<ol style="list-style-type: decimal">
<li>The <em>correspondence matrix</em> (the matrix of relative
frequencies) <span class="math inline">\(P = \frac{1}{n} X\)</span>
</li>
<li>The row and column weights <span class="math inline">\(r =
\frac{1}{n} X 1\)</span> and <span class="math inline">\(c = \frac{1}{n}
1^\top X\)</span>
</li>
<li>The diagonals of inverse weights <span class="math inline">\(D_r =
\operatorname{diag}(r)\)</span> and <span class="math inline">\(D_c =
\operatorname{diag}(c)\)</span>
</li>
<li>The matrix of <em>standardized residuals</em> <span class="math inline">\(S = D_r (P - rc) D_c\)</span>
</li>
<li>The singular value decomposition <span class="math inline">\(S = U
\Sigma V^\top\)</span>
</li>
<li>The row and column standard coordinates <span class="math inline">\(F = D_r U\)</span> and <span class="math inline">\(G = D_c V\)</span>
</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># correspondence matrix (matrix of relative frequencies)</span></span>
<span><span class="op">(</span><span class="va">haireye_p</span> <span class="op">&lt;-</span> <span class="va">haireye</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">haireye</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair         Brown       Blue      Hazel       Green</span></span>
<span><span class="co">#&gt;   Black 0.11486486 0.03378378 0.02533784 0.008445946</span></span>
<span><span class="co">#&gt;   Brown 0.20101351 0.14189189 0.09121622 0.048986486</span></span>
<span><span class="co">#&gt;   Red   0.04391892 0.02871622 0.02364865 0.023648649</span></span>
<span><span class="co">#&gt;   Blond 0.01182432 0.15878378 0.01689189 0.027027027</span></span>
<span><span class="co"># row and column weights</span></span>
<span><span class="op">(</span><span class="va">haireye_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">haireye</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">haireye</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Black     Brown       Red     Blond </span></span>
<span><span class="co">#&gt; 0.1824324 0.4831081 0.1199324 0.2145270</span></span>
<span><span class="op">(</span><span class="va">haireye_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">haireye</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">haireye</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Brown      Blue     Hazel     Green </span></span>
<span><span class="co">#&gt; 0.3716216 0.3631757 0.1570946 0.1081081</span></span>
<span><span class="co"># matrix of standardized residuals</span></span>
<span><span class="op">(</span><span class="va">haireye_s</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">haireye_r</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span></span>
<span>    <span class="op">(</span><span class="va">haireye_p</span> <span class="op">-</span> <span class="va">haireye_r</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">haireye_c</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">haireye_c</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;              [,1]        [,2]        [,3]        [,4]</span></span>
<span><span class="co">#&gt; [1,]  0.180773066 -0.12615064 -0.01961905 -0.08029590</span></span>
<span><span class="co">#&gt; [2,]  0.050694815 -0.08012300  0.05561963 -0.01418351</span></span>
<span><span class="co">#&gt; [3,] -0.003081574 -0.07110772  0.03502737  0.09381990</span></span>
<span><span class="co">#&gt; [4,] -0.240474512  0.28973637 -0.09156384  0.02518174</span></span>
<span><span class="co"># singular value decomposition</span></span>
<span><span class="va">haireye_svd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="va">haireye_s</span><span class="op">)</span></span>
<span><span class="co"># row and column standard coordinates</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">haireye_r</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">haireye_svd</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="co">#&gt;            [,1]       [,2]       [,3]</span></span>
<span><span class="co">#&gt; [1,] -1.1042772  1.4409170 -1.0889497</span></span>
<span><span class="co">#&gt; [2,] -0.3244635 -0.2191109  0.9574152</span></span>
<span><span class="co">#&gt; [3,] -0.2834725 -2.1440145 -1.6312184</span></span>
<span><span class="co">#&gt; [4,]  1.8282287  0.4667063 -0.3180920</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">haireye_c</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">haireye_svd</span><span class="op">$</span><span class="va">v</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="co">#&gt;            [,1]       [,2]        [,3]</span></span>
<span><span class="co">#&gt; [1,] -1.0771283  0.5924202 -0.42395984</span></span>
<span><span class="co">#&gt; [2,]  1.1980612  0.5564193  0.09238682</span></span>
<span><span class="co">#&gt; [3,] -0.4652862 -1.1227826  1.97191769</span></span>
<span><span class="co">#&gt; [4,]  0.3540108 -2.2741218 -1.71844295</span></span></code></pre></div>
<p>We can generate a biplot display via the <code><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot()</a></code> method
for the ‘correspondence’ class, also provided by
<strong>MASS</strong>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span></span>
<span>  <span class="va">haireye_ca</span>, type <span class="op">=</span> <span class="st">"symmetric"</span>, cex <span class="op">=</span> <span class="fl">.8</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Correspondence analysis of subjects' hair &amp; eye colors"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="ordr_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;"></p>
<p>This <em>symmetric biplot</em> evenly distributes the inertia between
the rows and columns. Distances between points in the same matrix factor
do not approximate their <span class="math inline">\(\chi^2\)</span>
distances, but inner products between row and column points approximate
their standardized residuals. The row and column profile markers are
resized to represent the masses of the groups.</p>
</div>
<div class="section level2">
<h2 id="ordr-methods-for-ca-models">
<strong>ordr</strong> methods for CA models<a class="anchor" aria-label="anchor" href="#ordr-methods-for-ca-models"></a>
</h2>
<p><strong>ordr</strong> provides a new class, ‘tbl_ord’, that wraps
ordination objects like those of class ‘prcomp’ without directly
modifying them. (The original model can be recovered with
<code><a href="../reference/tbl_ord.html">un_tbl_ord()</a></code>.)</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">haireye_ca_ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tbl_ord.html">as_tbl_ord</a></span><span class="op">(</span><span class="va">haireye_ca</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tbl_ord of class 'correspondence': (4 x 3) x (4 x 3)'</span></span>
<span><span class="co">#&gt; # 3 coordinates: Can1, Can2, Can3</span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; # Rows (standard): [ 4 x 3 | 0 ]</span></span>
<span><span class="co">#&gt;     Can1   Can2   Can3 | </span></span>
<span><span class="co">#&gt;                        | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">1.10</span>   1.44  -<span style="color: #BB0000;">1.09</span>  | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">0.324</span> -<span style="color: #BB0000;">0.219</span>  0.957 | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.283</span> -<span style="color: #BB0000;">2.14</span>  -<span style="color: #BB0000;">1.63</span>  | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  1.83   0.467 -<span style="color: #BB0000;">0.318</span> | </span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; # Columns (standard): [ 4 x 3 | 0 ]</span></span>
<span><span class="co">#&gt;     Can1   Can2    Can3 | </span></span>
<span><span class="co">#&gt;                         | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">1.08</span>   0.592 -<span style="color: #BB0000;">0.424</span>  | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  1.20   0.556  0.092<span style="text-decoration: underline;">4</span> | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.465</span> -<span style="color: #BB0000;">1.12</span>   1.97   | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  0.354 -<span style="color: #BB0000;">2.27</span>  -<span style="color: #BB0000;">1.72</span>   |</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> method for ‘tbl_ord’ is based on that of
tibbles. It prints two tibbles, like that for the ‘tbl_graph’ class of
<a href="https://tidygraph.data-imaginist.com/" class="external-link"><strong>tidygraph</strong></a>,
one for each matrix factor.</p>
<p>The header reminds us of the dimensions of the matrix factors and how
the inertia is distributed. In ‘correspondence’ objects, by default both
row and column profiles are in standard coordinates: <span class="math inline">\(D_r F\)</span> and <span class="math inline">\(D_c
G\)</span>, but these can be reassigned to any pair of proportions <span class="math inline">\(D_r S {D_c}^\top = (D_r U \Sigma^{p}) (D_c V
\Sigma^{q})^\top\)</span>, even if <span class="math inline">\(p + q
\neq 1\)</span>. By assigning <code>"symmetric"</code> inertia, we
distribute half of the inertia to each matrix factor:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/conference.html">get_conference</a></span><span class="op">(</span><span class="va">haireye_ca_ord</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0 0</span></span>
<span><span class="fu"><a href="../reference/conference.html">confer_inertia</a></span><span class="op">(</span><span class="va">haireye_ca_ord</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>, <span class="fl">.75</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tbl_ord of class 'correspondence': (4 x 3) x (4 x 3)'</span></span>
<span><span class="co">#&gt; # 3 coordinates: Can1, Can2, Can3</span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; # Rows (25% inertia): [ 4 x 3 | 0 ]</span></span>
<span><span class="co">#&gt;     Can1   Can2   Can3 | </span></span>
<span><span class="co">#&gt;                        | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">0.908</span>  0.895 -<span style="color: #BB0000;">0.517</span> | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">0.267</span> -<span style="color: #BB0000;">0.136</span>  0.455 | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.233</span> -<span style="color: #BB0000;">1.33</span>  -<span style="color: #BB0000;">0.775</span> | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  1.50   0.290 -<span style="color: #BB0000;">0.151</span> | </span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; # Columns (75% inertia): [ 4 x 3 | 0 ]</span></span>
<span><span class="co">#&gt;     Can1   Can2     Can3 | </span></span>
<span><span class="co">#&gt;                          | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">0.599</span>  0.142 -<span style="color: #BB0000;">0.045</span><span style="color: #BB0000; text-decoration: underline;">5</span>  | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  0.666  0.133  0.009<span style="text-decoration: underline;">91</span> | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.259</span> -<span style="color: #BB0000;">0.269</span>  0.212   | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  0.197 -<span style="color: #BB0000;">0.546</span> -<span style="color: #BB0000;">0.184</span>   |</span></span>
<span><span class="fu"><a href="../reference/conference.html">confer_inertia</a></span><span class="op">(</span><span class="va">haireye_ca_ord</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in confer_inertia(haireye_ca_ord, c(1, 1)): Inertia is not balanced.</span></span>
<span><span class="co">#&gt; # A tbl_ord of class 'correspondence': (4 x 3) x (4 x 3)'</span></span>
<span><span class="co">#&gt; # 3 coordinates: Can1, Can2, Can3</span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; # Rows (principal): [ 4 x 3 | 0 ]</span></span>
<span><span class="co">#&gt;     Can1    Can2    Can3 | </span></span>
<span><span class="co">#&gt;                          | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">0.505</span>  0.215  -<span style="color: #BB0000;">0.055</span><span style="color: #BB0000; text-decoration: underline;">5</span> | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">0.148</span> -<span style="color: #BB0000;">0.032</span><span style="color: #BB0000; text-decoration: underline;">7</span>  0.048<span style="text-decoration: underline;">8</span> | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.130</span> -<span style="color: #BB0000;">0.320</span>  -<span style="color: #BB0000;">0.083</span><span style="color: #BB0000; text-decoration: underline;">2</span> | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  0.835  0.069<span style="text-decoration: underline;">6</span> -<span style="color: #BB0000;">0.016</span><span style="color: #BB0000; text-decoration: underline;">2</span> | </span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; # Columns (principal): [ 4 x 3 | 0 ]</span></span>
<span><span class="co">#&gt;     Can1    Can2     Can3 | </span></span>
<span><span class="co">#&gt;                           | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">0.492</span>  0.088<span style="text-decoration: underline;">3</span> -<span style="color: #BB0000;">0.021</span><span style="color: #BB0000; text-decoration: underline;">6</span>  | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  0.547  0.083<span style="text-decoration: underline;">0</span>  0.004<span style="text-decoration: underline;">71</span> | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.213</span> -<span style="color: #BB0000;">0.167</span>   0.101   | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  0.162 -<span style="color: #BB0000;">0.339</span>  -<span style="color: #BB0000;">0.087</span><span style="color: #BB0000; text-decoration: underline;">6</span>  |</span></span>
<span><span class="op">(</span><span class="va">haireye_ca_ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conference.html">confer_inertia</a></span><span class="op">(</span><span class="va">haireye_ca_ord</span>, <span class="st">"symmetric"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tbl_ord of class 'correspondence': (4 x 3) x (4 x 3)'</span></span>
<span><span class="co">#&gt; # 3 coordinates: Can1, Can2, Can3</span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; # Rows (symmetric): [ 4 x 3 | 0 ]</span></span>
<span><span class="co">#&gt;     Can1    Can2    Can3 | </span></span>
<span><span class="co">#&gt;                          | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">0.746</span>  0.556  -<span style="color: #BB0000;">0.246</span>  | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">0.219</span> -<span style="color: #BB0000;">0.084</span><span style="color: #BB0000; text-decoration: underline;">6</span>  0.216  | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.192</span> -<span style="color: #BB0000;">0.828</span>  -<span style="color: #BB0000;">0.368</span>  | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  1.24   0.180  -<span style="color: #BB0000;">0.071</span><span style="color: #BB0000; text-decoration: underline;">8</span> | </span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; # Columns (symmetric): [ 4 x 3 | 0 ]</span></span>
<span><span class="co">#&gt;     Can1   Can2    Can3 | </span></span>
<span><span class="co">#&gt;                         | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">0.728</span>  0.229 -<span style="color: #BB0000;">0.095</span><span style="color: #BB0000; text-decoration: underline;">7</span> | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  0.810  0.215  0.020<span style="text-decoration: underline;">9</span> | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.315</span> -<span style="color: #BB0000;">0.434</span>  0.445  | </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  0.239 -<span style="color: #BB0000;">0.878</span> -<span style="color: #BB0000;">0.388</span>  |</span></span></code></pre></div>
<p><code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">broom::glance()</a></code> returns a single-row tibble summary of a
model object. It was designed for analysis pipelines involving multiple
models (e.g. model selection), to facilitate summaries of multiple
models at once. ‘tbl_ord’ objects wrap a potentially huge variety of
models, for which only a few summary statistics will usually be useful.
This method includes the rank of the matrix factorization; the
proportion of inertia/variance in the first two dimensions, which
characterize the fidelity of a biplot to the complete data; and the
original object class.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">haireye_ca_ord</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 7</span></span></span>
<span><span class="co">#&gt;    rank n.row n.col inertia prop.var.1 prop.var.2 class         </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     3     4     4   0.234      0.894     0.095<span style="text-decoration: underline;">1</span> correspondence</span></span></code></pre></div>
<p>Analogous to <code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">broom::augment()</a></code>, this tbl_ord-specific
function preserves the ‘tbl_ord’ class but augments the row and column
tibbles with any metadata or diagnostics found in the model object.
Vertical bars separate the coordinate matrices from annotations.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/augmentation.html">augment_ord</a></span><span class="op">(</span><span class="va">haireye_ca_ord</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tbl_ord of class 'correspondence': (4 x 3) x (4 x 3)'</span></span>
<span><span class="co">#&gt; # 3 coordinates: Can1, Can2, Can3</span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; # Rows (symmetric): [ 4 x 3 | 1 ]</span></span>
<span><span class="co">#&gt;     Can1    Can2    Can3 |   name </span></span>
<span><span class="co">#&gt;                          |   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">0.746</span>  0.556  -<span style="color: #BB0000;">0.246</span>  | <span style="color: #BCBCBC;">1</span> Black</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">0.219</span> -<span style="color: #BB0000;">0.084</span><span style="color: #BB0000; text-decoration: underline;">6</span>  0.216  | <span style="color: #BCBCBC;">2</span> Brown</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.192</span> -<span style="color: #BB0000;">0.828</span>  -<span style="color: #BB0000;">0.368</span>  | <span style="color: #BCBCBC;">3</span> Red  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  1.24   0.180  -<span style="color: #BB0000;">0.071</span><span style="color: #BB0000; text-decoration: underline;">8</span> | <span style="color: #BCBCBC;">4</span> Blond</span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; # Columns (symmetric): [ 4 x 3 | 1 ]</span></span>
<span><span class="co">#&gt;     Can1   Can2    Can3 |   name </span></span>
<span><span class="co">#&gt;                         |   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">0.728</span>  0.229 -<span style="color: #BB0000;">0.095</span><span style="color: #BB0000; text-decoration: underline;">7</span> | <span style="color: #BCBCBC;">1</span> Brown</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  0.810  0.215  0.020<span style="text-decoration: underline;">9</span> | <span style="color: #BCBCBC;">2</span> Blue </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.315</span> -<span style="color: #BB0000;">0.434</span>  0.445  | <span style="color: #BCBCBC;">3</span> Hazel</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  0.239 -<span style="color: #BB0000;">0.878</span> -<span style="color: #BB0000;">0.388</span>  | <span style="color: #BCBCBC;">4</span> Green</span></span></code></pre></div>
<p>Additional row- and column-level variables can also be augmented and
manipulated using a handful of <strong>dplyr</strong>-like verbs, each
specific to the matrix factor being affected (<code>rows</code> or
<code>cols</code>). Each tibble is split between the shared coordinates
on the left and any additional annotation columns on the right.</p>
<p>The <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">broom::tidy()</a></code> method for tbl_ords returns a tibble
with one row per artificial coordinate.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Note that &lt;code&gt;&lt;a href="https://generics.r-lib.org/reference/tidy.html" class="external-link"&gt;ordr::tidy()&lt;/a&gt;&lt;/code&gt; takes precedence for
‘tbl_ord’ objects over the class of the underlying model because the
‘tbl_ord’ class precedes this class.&lt;/p&gt;'><sup>2</sup></a> In CA, these are
variably called dimensions or components. The ‘correspondence’ object
contains a <code>$cor</code> vector of canonical correlations, which is
included in the result; other coordinate-level attributes vary by model
object class.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">haireye_ca_ord</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   name     cor inertia prop_var quality</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Can1  0.457  0.209     0.894    0.894</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Can2  0.149  0.022<span style="text-decoration: underline;">2</span>    0.095<span style="text-decoration: underline;">1</span>   0.989</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Can3  0.051<span style="text-decoration: underline;">0</span> 0.002<span style="text-decoration: underline;">60</span>   0.011<span style="text-decoration: underline;">1</span>   1</span></span></code></pre></div>
<p>The <code>.inertia</code> and <code>.prop_var</code> fields are
calculated from the singular values or eigenvalues contained in the
ordination object and always appear when defined. This means that
<code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> prepares any ordination object derived from such a
decomposition for a scree plot with <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">haireye_ca_ord</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">name</span>, y <span class="op">=</span> <span class="va">inertia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Component"</span>, y <span class="op">=</span> <span class="st">"Inertia"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Correspondence analysis of subjects' hair &amp; eye colors"</span>,</span>
<span>          <span class="st">"Decomposition of inertia"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ordr_files/figure-html/scree%20plot-1.png" width="576" style="display: block; margin: auto;"></p>
<p>While <code><a href="https://ggplot2.tidyverse.org/reference/fortify.html" class="external-link">ggplot2::fortify()</a></code> may rarely be called directly,
is plays a special role in <strong>ordr</strong> by converting a
‘tbl_ord’ object to a ‘tbl_df’ object. To do this, the fortifier
row-binds the two matrix factor tibbles and adds an additional
<code>.matrix</code> column to remember which was which:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/fortify.html" class="external-link">fortify</a></span><span class="op">(</span><span class="va">haireye_ca_ord</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 5</span></span></span>
<span><span class="co">#&gt;     Can1    Can2    Can3 .element .matrix</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">0.746</span>  0.556  -<span style="color: #BB0000;">0.246</span>  active   rows   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">0.219</span> -<span style="color: #BB0000;">0.084</span><span style="color: #BB0000; text-decoration: underline;">6</span>  0.216  active   rows   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.192</span> -<span style="color: #BB0000;">0.828</span>  -<span style="color: #BB0000;">0.368</span>  active   rows   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  1.24   0.180  -<span style="color: #BB0000;">0.071</span><span style="color: #BB0000; text-decoration: underline;">8</span> active   rows   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> -<span style="color: #BB0000;">0.728</span>  0.229  -<span style="color: #BB0000;">0.095</span><span style="color: #BB0000; text-decoration: underline;">7</span> active   cols   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  0.810  0.215   0.020<span style="text-decoration: underline;">9</span> active   cols   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> -<span style="color: #BB0000;">0.315</span> -<span style="color: #BB0000;">0.434</span>   0.445  active   cols   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span>  0.239 -<span style="color: #BB0000;">0.878</span>  -<span style="color: #BB0000;">0.388</span>  active   cols</span></span></code></pre></div>
<p>This fortifier will also preserve any row and column annotations, so
it can be composed with <code><a href="../reference/augmentation.html">augment_ord()</a></code> or with the row- and
column-specific verbs. <code>NA</code>s are introduced when an
annotation is present for one matrix factor but not the other. (The
<code>.element</code> column becomes important when a model produces
supplementary as well as active elements.)</p>
<p>The <code>.matrix</code> column also plays a key role in
<code><a href="../reference/ggbiplot.html">ggbiplot()</a></code>: The row- and column-specific ploy layers, which
take the form <code>geom_rows_*()</code> or <code>stat_cols_*()</code>,
for example, use this column to subset the data internally. This enables
the layered grammar of graphics of <strong>ggplot2</strong> to apply
separately to the two matrix factors and their annotation. Though note
that it can also be applied to the entire fortified data frame using
conventional plot layers, as below when the <code>.matrix</code> column
is used to distinguish the colors and shapes of the row and column
profile markers:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">haireye_ca_ord</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/augmentation.html">augment_ord</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/fortify.html" class="external-link">fortify</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>feature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">.matrix</span> <span class="op">==</span> <span class="st">"rows"</span>, <span class="st">"Hair"</span>, <span class="st">"Eye"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">feature</span>, shape <span class="op">=</span> <span class="va">feature</span>, label <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_scaffold.html">theme_biplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_origin.html">geom_origin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/biplot-geoms.html">geom_cols_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/biplot-geoms.html">geom_rows_text</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, hjust <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/biplot-geoms.html">geom_cols_text</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, hjust <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"qual"</span>, palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size_area</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Correspondence analysis of subjects' hair &amp; eye colors"</span>,</span>
<span>          <span class="st">"Symmetric biplot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ordr_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Note a few conveniences:</p>
<ul>
<li>The position aesthetics are assumed to be the first and second
artificial coordinates, unless otherwise specified. Biplots can also be
specified by setting the <code>x</code> and <code>y</code> aesthetics to
integers, which are converted to the corresponding artificial
coordinates.</li>
<li>By default, the aspect ratio is set to 1. This is essential for
biplots, which rely on distances between markers and angles between
vectors to convey information.</li>
<li>The partial theme <code><a href="../reference/theme_scaffold.html">theme_biplot()</a></code> removes several plot
elements that are usually not important to biplots, most notably
gridlines, while retaining other properties of the current theme.</li>
<li>The layer <code><a href="../reference/geom_origin.html">geom_origin()</a></code> is one of two shortcuts for
plotting elements commonly used in biplots, the other being
<code><a href="../reference/geom_origin.html">geom_unit_circle()</a></code>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="session-info">session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://sessioninfo.r-lib.org/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Session info ───────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">setting </span> <span style="color: #555555; font-style: italic;">value</span></span></span>
<span><span class="co">#&gt;  version  R version 4.4.2 (2024-10-31)</span></span>
<span><span class="co">#&gt;  os       macOS Sonoma 14.4.1</span></span>
<span><span class="co">#&gt;  system   aarch64, darwin20</span></span>
<span><span class="co">#&gt;  ui       X11</span></span>
<span><span class="co">#&gt;  language en</span></span>
<span><span class="co">#&gt;  collate  en_US.UTF-8</span></span>
<span><span class="co">#&gt;  ctype    en_US.UTF-8</span></span>
<span><span class="co">#&gt;  tz       America/Los_Angeles</span></span>
<span><span class="co">#&gt;  date     2025-07-11</span></span>
<span><span class="co">#&gt;  pandoc   2.19 @ /opt/homebrew/bin/ (via rmarkdown)</span></span>
<span><span class="co">#&gt;  quarto   NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Packages ───────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">package     </span> <span style="color: #555555; font-style: italic;">*</span> <span style="color: #555555; font-style: italic;">version</span> <span style="color: #555555; font-style: italic;">date (UTC)</span> <span style="color: #555555; font-style: italic;">lib</span> <span style="color: #555555; font-style: italic;">source</span></span></span>
<span><span class="co">#&gt;  bslib          0.9.0   <span style="color: #555555;">2025-01-30</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  cachem         1.1.0   <span style="color: #555555;">2024-05-16</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  cli            3.6.5   <span style="color: #555555;">2025-04-23</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  desc           1.4.3   <span style="color: #555555;">2023-12-10</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  digest         0.6.37  <span style="color: #555555;">2024-08-19</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  dplyr          1.1.4   <span style="color: #555555;">2023-11-17</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.0)</span></span></span>
<span><span class="co">#&gt;  evaluate       1.0.4   <span style="color: #555555;">2025-06-18</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  farver         2.1.2   <span style="color: #555555;">2024-05-13</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  fastmap        1.2.0   <span style="color: #555555;">2024-05-15</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  fs             1.6.6   <span style="color: #555555;">2025-04-12</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  generics       0.1.4   <span style="color: #555555;">2025-05-09</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  gggda          0.1.1   <span style="color: #555555;">2025-07-09</span> <span style="color: #555555;">[2]</span> <span style="color: #BB00BB; font-weight: bold;">Github (corybrunson/gggda@91e7e82)</span></span></span>
<span><span class="co">#&gt;  ggplot2      * 3.5.2   <span style="color: #555555;">2025-04-09</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  ggrepel        0.9.6   <span style="color: #555555;">2024-09-07</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  glue           1.8.0   <span style="color: #555555;">2024-09-30</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  gtable         0.3.6   <span style="color: #555555;">2024-10-25</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  htmltools      0.5.8.1 <span style="color: #555555;">2024-04-04</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  htmlwidgets    1.6.4   <span style="color: #555555;">2023-12-06</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.0)</span></span></span>
<span><span class="co">#&gt;  jquerylib      0.1.4   <span style="color: #555555;">2021-04-26</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.0)</span></span></span>
<span><span class="co">#&gt;  jsonlite       2.0.0   <span style="color: #555555;">2025-03-27</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  knitr          1.50    <span style="color: #555555;">2025-03-16</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  labeling       0.4.3   <span style="color: #555555;">2023-08-29</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  lifecycle      1.0.4   <span style="color: #555555;">2023-11-07</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  magrittr       2.0.3   <span style="color: #555555;">2022-03-30</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  MASS         * 7.3-65  <span style="color: #555555;">2025-02-28</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  ordr         * 0.2.0   <span style="color: #555555;">2025-07-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">local</span></span></span>
<span><span class="co">#&gt;  pillar         1.11.0  <span style="color: #555555;">2025-07-04</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  pkgconfig      2.0.3   <span style="color: #555555;">2019-09-22</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  pkgdown        2.1.3   <span style="color: #555555;">2025-05-25</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  purrr          1.0.4   <span style="color: #555555;">2025-02-05</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  R6             2.6.1   <span style="color: #555555;">2025-02-15</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  ragg           1.4.0   <span style="color: #555555;">2025-04-10</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  RColorBrewer   1.1-3   <span style="color: #555555;">2022-04-03</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  Rcpp           1.1.0   <span style="color: #555555;">2025-07-02</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  rlang          1.1.6   <span style="color: #555555;">2025-04-11</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  rmarkdown      2.29    <span style="color: #555555;">2024-11-04</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  sass           0.4.10  <span style="color: #555555;">2025-04-11</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  scales         1.4.0   <span style="color: #555555;">2025-04-24</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  sessioninfo    1.2.3   <span style="color: #555555;">2025-02-05</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  stringi        1.8.7   <span style="color: #555555;">2025-03-27</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  stringr        1.5.1   <span style="color: #555555;">2023-11-14</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.0)</span></span></span>
<span><span class="co">#&gt;  systemfonts    1.2.3   <span style="color: #555555;">2025-04-30</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  textshaping    1.0.1   <span style="color: #555555;">2025-05-01</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  tibble         3.3.0   <span style="color: #555555;">2025-06-08</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  tidyr          1.3.1   <span style="color: #555555;">2024-01-24</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  tidyselect     1.2.1   <span style="color: #555555;">2024-03-11</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.0)</span></span></span>
<span><span class="co">#&gt;  utf8           1.2.6   <span style="color: #555555;">2025-06-08</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  vctrs          0.6.5   <span style="color: #555555;">2023-12-01</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.0)</span></span></span>
<span><span class="co">#&gt;  withr          3.0.2   <span style="color: #555555;">2024-10-28</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  xfun           0.52    <span style="color: #555555;">2025-04-02</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt;  yaml           2.3.10  <span style="color: #555555;">2024-07-26</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.4.1)</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [1] /private/var/folders/4p/3cy0qmp15x9216qsqhh84kzm0000gn/T/Rtmpeg6yc1/temp_libpath10aec49825958</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [2] /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library</span></span></span>
<span><span class="co">#&gt;  <span style="color: #BBBBBB; background-color: #BB0000;">*</span> ── Packages attached to the search path.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">──────────────────────────────────────────────────────────────────────────────</span></span></span></code></pre></div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jason Cory Brunson, John Gracey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
