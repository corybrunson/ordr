<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Tidyverse Extension for Ordinations and Biplots • ordr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="A Tidyverse Extension for Ordinations and Biplots">
<meta property="og:description" content="Ordination comprises several multivariate exploratory and explanatory techniques with theoretical foundations in geometric data analysis; see Podani (2000, ISBN:90-5782-067-6) for techniques and applications and Le Roux &amp; Rouanet (2005) &lt;doi:10.1007/1-4020-2236-0&gt; for foundations. Greenacre (2010, ISBN:978-84-923846) shows how the most established of these, including principal components analysis, correspondence analysis, multidimensional scaling, factor analysis, and discriminant analysis, rely on eigen-decompositions or singular value decompositions of pre-processed numeric matrix data. These decompositions give rise to a set of shared coordinates along which the row and column elements can be measured. The overlay of their scatterplots on these axes, introduced by Gabriel (1971) &lt;doi:10.1093/biomet/58.3.453&gt;, is called a biplot. ordr provides inspection, extraction, manipulation, and visualization tools for several popular ordination classes supported by a set of recovery methods. It is inspired by and designed to integrate into tidyverse workflows provided by Wickham et al (2019) &lt;doi:10.21105/joss.01686&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ordr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1.0002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/ordr.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/cmds-variables.html">multidimensional scaling of variables</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/corybrunson/ordr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="ordr">ordr<a class="anchor" aria-label="anchor" href="#ordr"></a>
</h1></div>
<!-- badges: start -->
<p><strong>ordr</strong> integrates ordination analysis and biplot visualization into <a href="https://github.com/tidyverse/tidyverse" class="external-link"><strong>tidyverse</strong></a> workflows.</p>
<div class="section level2">
<h2 id="motivation">motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<blockquote><p>Wherever there is an SVD, there is a biplot.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p></blockquote>
<div class="section level3">
<h3 id="ordination-and-biplots">ordination and biplots<a class="anchor" aria-label="anchor" href="#ordination-and-biplots"></a>
</h3>
<p><em>Ordination</em> is a catch-all term for a variety of statistical techniques that introduce an artificial coordinate system for a data set in such a way that a few coordinates capture a large amount of the data structure <a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>. The branch of mathematical statistics called <a href="https://link.springer.com/book/10.1007/1-4020-2236-0" class="external-link">geometric data analysis</a> (GDA) provides the theoretical basis for (most of) these techniques. Ordination overlaps with regression and with dimension reduction, which can be <a href="https://towardsdatascience.com/supervised-vs-unsupervised-learning-14f68e32ea8d" class="external-link">contrasted to clustering and classification</a> in that they assign continuous rather than categorical values to data elements <a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>.</p>
<p>Most ordination techniques decompose a numeric rectangular data set into the product of two matrices, often using singular value decomposition (SVD). The coordinates of the shared dimensions of these matrices (over which they are multiplied) are the artificial coordinates. In some cases, such as principal components analysis, the decomposition is exact; in others, such as non-negative matrix factorization, it is approximate. Some techniques, such as correspondence analysis, transform the data before decomposition. Ordination techniques may be supervised, like linear discriminant analysis, or unsupervised, like multidimensional scaling.</p>
<p>Analysis pipelines that use these techniques may use the artificial coordinates directly, in place of natural coordinates, to arrange and compare data elements or to predict responses. This is possible because both the rows and the columns of the original table can be located, or positioned, along these shared coordinates. The number of artificial coordinates used in an application, such as regression or visualization, is called the <em>rank</em> of the ordination <a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>. A common application is the <em>biplot</em>, which positions the rows and columns of the original table in a scatterplot in 1, 2, or 3 artificial coordinates, usually those that explain the most variation in the data.</p>
</div>
<div class="section level3">
<h3 id="implementations-in-r">implementations in R<a class="anchor" aria-label="anchor" href="#implementations-in-r"></a>
</h3>
<p>An extensive range of ordination techniques are implemented in R, from classical multidimensional scaling (<code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">stats::cmdscale()</a></code>) and principal components analysis (<code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">stats::prcomp()</a></code> and <code><a href="https://rdrr.io/r/stats/princomp.html" class="external-link">stats::princomp()</a></code>) in the <strong>stats</strong> package distributed with base R, across widely-used implementations of linear discriminant analysis (<code><a href="https://rdrr.io/pkg/MASS/man/lda.html" class="external-link">MASS::lda()</a></code>) and correspondence analysis (<code><a href="https://rdrr.io/pkg/ca/man/ca.html" class="external-link">ca::ca()</a></code>) in general-use statistical packages, to highly specialized packages that implement cutting-edge techniques or adapt conventional techniques to challenging settings. These implementations come with their own conventions, tailored to the research communities that produced them, and it would be impractical (and probably unhelpful) to try to consolidate them.</p>
<p>Instead, <strong>ordr</strong> provides a streamlined process by which the models output by these methods—in particular, the matrix factors into which the original data are approximately decomposed and the artificial coordinates they share—can be inspected, annotated, tabulated, summarized, and visualized. On this last point, most biplot implementations in R provide limited customizability. <strong>ordr</strong> adopts the grammar of graphics paradigm from <a href="https://github.com/tidyverse/ggplot2" class="external-link"><strong>ggplot2</strong></a> to modularize and standardize biplot elements <a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>. Overall, the package is designed to follow the broader syntactic conventions of the <strong>tidyverse</strong>, so that users familiar with a this workflow can more easily and quickly integrate ordination models into practice.</p>
</div>
</div>
<div class="section level2">
<h2 id="usage">usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="section level3">
<h3 id="installation">installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p><strong>ordr</strong> is now on CRAN and can be installed using base R:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ordr"</span><span class="op">)</span></span></code></pre></div>
<p>The development version can be installed from the (default) <code>main</code> branch using <a href="https://github.com/r-lib/remotes" class="external-link"><strong>remotes</strong></a>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"corybrunson/ordr"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example">example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<blockquote><p>Morphologically, <em>Iris versicolor</em> is much closer to <em>Iris virginica</em> than to <em>Iris setosa</em>, though in every character by which it differs from <em>Iris virginica</em> it departs in the direction of <em>Iris setosa</em>.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a></p></blockquote>
<p>A very common illustration of ordination in R applies principal components analysis (PCA) to Anderson’s iris measurements. These data consist of lengths and widths of the petals and surrounding sepals from 50 each of three species of iris:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span><span class="co">#&gt; 1          5.1         3.5          1.4         0.2  setosa</span></span>
<span><span class="co">#&gt; 2          4.9         3.0          1.4         0.2  setosa</span></span>
<span><span class="co">#&gt; 3          4.7         3.2          1.3         0.2  setosa</span></span>
<span><span class="co">#&gt; 4          4.6         3.1          1.5         0.2  setosa</span></span>
<span><span class="co">#&gt; 5          5.0         3.6          1.4         0.2  setosa</span></span>
<span><span class="co">#&gt; 6          5.4         3.9          1.7         0.4  setosa</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   </span></span>
<span><span class="co">#&gt;  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  </span></span>
<span><span class="co">#&gt;  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  </span></span>
<span><span class="co">#&gt;  Median :5.800   Median :3.000   Median :4.350   Median :1.300  </span></span>
<span><span class="co">#&gt;  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  </span></span>
<span><span class="co">#&gt;  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  </span></span>
<span><span class="co">#&gt;  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  </span></span>
<span><span class="co">#&gt;        Species  </span></span>
<span><span class="co">#&gt;  setosa    :50  </span></span>
<span><span class="co">#&gt;  versicolor:50  </span></span>
<span><span class="co">#&gt;  virginica :50  </span></span>
<span><span class="co">#&gt;                 </span></span>
<span><span class="co">#&gt;                 </span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p><strong>ordr</strong> provides a convenience function to send a subset of columns to an ordination function, wrap the resulting model in the <a href="https://github.com/tidyverse/tibble" class="external-link"><strong>tibble</strong></a>-derived ‘tbl_ord’ class, and append both model diagnostics and other original data columns as annotations to the appropriate matrix factors:<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">iris_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ordinate.html">ordinate</a></span><span class="op">(</span><span class="va">iris</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, model <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="va">.</span>, scale. <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tbl_ord of class 'prcomp': (150 x 4) x (4 x 4)'</span></span>
<span><span class="co">#&gt; # 4 coordinates: PC1, PC2, ..., PC4</span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; # Rows (principal): [ 150 x 4 | 1 ]</span></span>
<span><span class="co">#&gt;     PC1    PC2     PC3 ... |   Species</span></span>
<span><span class="co">#&gt;                            |   &lt;fct&gt;  </span></span>
<span><span class="co">#&gt; 1 -2.26 -0.478  0.127      | 1 setosa </span></span>
<span><span class="co">#&gt; 2 -2.07  0.672  0.234  ... | 2 setosa </span></span>
<span><span class="co">#&gt; 3 -2.36  0.341 -0.0441     | 3 setosa </span></span>
<span><span class="co">#&gt; 4 -2.29  0.595 -0.0910     | 4 setosa </span></span>
<span><span class="co">#&gt; 5 -2.38 -0.645 -0.0157     | 5 setosa </span></span>
<span><span class="co">#&gt; # ℹ 145 more rows</span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; # Columns (standard): [ 4 x 4 | 3 ]</span></span>
<span><span class="co">#&gt;      PC1     PC2    PC3 ... |   name         center scale</span></span>
<span><span class="co">#&gt;                             |   &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  0.521 -0.377   0.720     | 1 Sepal.Length   5.84 0.828</span></span>
<span><span class="co">#&gt; 2 -0.269 -0.923  -0.244 ... | 2 Sepal.Width    3.06 0.436</span></span>
<span><span class="co">#&gt; 3  0.580 -0.0245 -0.142     | 3 Petal.Length   3.76 1.77 </span></span>
<span><span class="co">#&gt; 4  0.565 -0.0669 -0.634     | 4 Petal.Width    1.20 0.762</span></span></code></pre></div>
<p>Additional annotations can be added using several row- and column-specific <strong>dplyr</strong>-style verbs:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"setosa"</span>, <span class="st">"versicolor"</span>, <span class="st">"virginica"</span><span class="op">)</span>,</span>
<span>  Colony <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">1L</span>, <span class="fl">2L</span><span class="op">)</span>,</span>
<span>  Cytotype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"diploid"</span>, <span class="st">"hexaploid"</span>, <span class="st">"tetraploid"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">iris_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dplyr-verbs.html">left_join_rows</a></span><span class="op">(</span><span class="va">iris_pca</span>, <span class="va">iris_meta</span>, by <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tbl_ord of class 'prcomp': (150 x 4) x (4 x 4)'</span></span>
<span><span class="co">#&gt; # 4 coordinates: PC1, PC2, ..., PC4</span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; # Rows (principal): [ 150 x 4 | 3 ]</span></span>
<span><span class="co">#&gt;     PC1    PC2     PC3 ... |   Species Colony Cytotype</span></span>
<span><span class="co">#&gt;                            |   &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;   </span></span>
<span><span class="co">#&gt; 1 -2.26 -0.478  0.127      | 1 setosa       1 diploid </span></span>
<span><span class="co">#&gt; 2 -2.07  0.672  0.234  ... | 2 setosa       1 diploid </span></span>
<span><span class="co">#&gt; 3 -2.36  0.341 -0.0441     | 3 setosa       1 diploid </span></span>
<span><span class="co">#&gt; 4 -2.29  0.595 -0.0910     | 4 setosa       1 diploid </span></span>
<span><span class="co">#&gt; 5 -2.38 -0.645 -0.0157     | 5 setosa       1 diploid </span></span>
<span><span class="co">#&gt; # ℹ 145 more rows</span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; # Columns (standard): [ 4 x 4 | 3 ]</span></span>
<span><span class="co">#&gt;      PC1     PC2    PC3 ... |   name         center scale</span></span>
<span><span class="co">#&gt;                             |   &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  0.521 -0.377   0.720     | 1 Sepal.Length   5.84 0.828</span></span>
<span><span class="co">#&gt; 2 -0.269 -0.923  -0.244 ... | 2 Sepal.Width    3.06 0.436</span></span>
<span><span class="co">#&gt; 3  0.580 -0.0245 -0.142     | 3 Petal.Length   3.76 1.77 </span></span>
<span><span class="co">#&gt; 4  0.565 -0.0669 -0.634     | 4 Petal.Width    1.20 0.762</span></span></code></pre></div>
<p>Following the <a href="https://github.com/tidymodels/broom" class="external-link"><strong>broom</strong></a> package, the <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> method produces a tibble describing the model components, in this case the principal coordinates, which is suitable for scree plotting:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">iris_pca</span><span class="op">)</span> <span class="op">%T&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">name</span>, y <span class="op">=</span> <span class="va">prop_var</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Proportion of inertia"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"PCA of Anderson's iris measurements"</span>,</span>
<span>          <span class="st">"Distribution of inertia"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 5</span></span>
<span><span class="co">#&gt;   name   sdev inertia prop_var quality</span></span>
<span><span class="co">#&gt;   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 PC1   1.71   435.    0.730     0.730</span></span>
<span><span class="co">#&gt; 2 PC2   0.956  136.    0.229     0.958</span></span>
<span><span class="co">#&gt; 3 PC3   0.383   21.9   0.0367    0.995</span></span>
<span><span class="co">#&gt; 4 PC4   0.144    3.09  0.00518   1</span></span></code></pre></div>
<p><img src="reference/figures/README-model%20components%20and%20scree%20plot-1.png"><!-- --></p>
<p>Following <strong>ggplot2</strong>, the <code>fortify()</code> method row-binds the factor tibbles with an additional <code>.matrix</code> column. This is used by <code><a href="reference/ggbiplot.html">ggbiplot()</a></code> to redirect row- and column-specific plot layers to the appropriate subsets:<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="va">iris_pca</span>, sec.axes <span class="op">=</span> <span class="st">"cols"</span>, scale.factor <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">Species</span>, shape <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/biplot-stats.html">stat_rows_ellipse</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.5</span>, level <span class="op">=</span> <span class="fl">.99</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/biplot-geoms.html">geom_cols_vector</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">expand_limits</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.5</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"PCA of Anderson's iris measurements"</span>,</span>
<span>          <span class="st">"99% confidence ellipses; variables use top &amp; right axes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-interpolative%20biplot-1.png"><!-- --></p>
<p>When variables are represented in standard coordinates, as typically in PCA, their rules can be rescaled to yield a predictive biplot.<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a> For legibility, the axes are limited to the data range and offset from the origin:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="va">iris_pca</span>, axis.type <span class="op">=</span> <span class="st">"predictive"</span>, axis.percents <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/theme_scaffold.html">theme_scaffold</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">Species</span>, shape <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/biplot-stats.html">stat_rows_center</a></span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">Species</span>, shape <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">.5</span>, fun.data <span class="op">=</span> <span class="va">mean_se</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/biplot-stats.html">stat_cols_rule</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span>, center <span class="op">=</span> <span class="va">center</span>, scale <span class="op">=</span> <span class="va">scale</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Predictive biplot of Anderson's iris measurements"</span>,</span>
<span>          <span class="st">"Project a marker onto an axis to approximate its measurement"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-predictive%20biplot-1.png"><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, by <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>, <span class="st">"Species"</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Species Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span><span class="co">#&gt; 1     setosa        5.006       3.428        1.462       0.246</span></span>
<span><span class="co">#&gt; 2 versicolor        5.936       2.770        4.260       1.326</span></span>
<span><span class="co">#&gt; 3  virginica        6.588       2.974        5.552       2.026</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="more-methods">more methods<a class="anchor" aria-label="anchor" href="#more-methods"></a>
</h3>
<p>The auxiliary package <a href="https://github.com/corybrunson/ordr.extra" class="external-link"><strong>ordr.extra</strong></a> provides recovery methods for several additional ordination models—and has room for several more!</p>
</div>
</div>
<div class="section level2">
<h2 id="acknowledgments">acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h2>
<div class="section level3">
<h3 id="contribute">contribute<a class="anchor" aria-label="anchor" href="#contribute"></a>
</h3>
<p>Any feedback on the package is very welcome! If you encounter confusion or errors, do create an issue, with a <a href="https://stackoverflow.com/help/minimal-reproducible-example" class="external-link">minimal reproducible example</a> if feasible. If you have requests, suggestions, or your own implementations for new features, feel free to create an issue or submit a pull request. Methods for additional ordination classes (see the <code>methods-*.r</code> scripts in the <code>R</code> folder) are especially welcome, as are new plot layers. Please try to follow the <a href="https://github.com/corybrunson/ordr/blob/main/CONTRIBUTING.md" class="external-link">contributing guidelines</a> and respect the <a href="https://github.com/corybrunson/ordr/blob/main/CODE_OF_CONDUCT.md" class="external-link">Code of Conduct</a>.</p>
</div>
<div class="section level3">
<h3 id="inspirations">inspirations<a class="anchor" aria-label="anchor" href="#inspirations"></a>
</h3>
<p>This package was originally inspired by the <strong>ggbiplot</strong> extension developed by <a href="https://github.com/vqv/ggbiplot" class="external-link">Vincent Q. Vu</a>, <a href="https://github.com/richardjtelford/ggbiplot" class="external-link">Richard J Telford</a>, and <a href="https://github.com/forked-packages/ggbiplot" class="external-link">Vilmantas Gegzna</a>, among others. It probably first brought biplots into the <strong>tidyverse</strong> framework. The motivation to unify a variety of ordination methods came from several books and articles by <a href="https://www.fbbva.es/microsite/multivariate-statistics/resources.html" class="external-link">Michael Greenacre</a>, in particular <a href="https://www.fbbva.es/microsite/multivariate-statistics/resources.html#biplots" class="external-link"><em>Biplots in Practice</em></a>. Several answers at CrossValidated, in particular by <a href="https://stats.stackexchange.com/users/28666/amoeba" class="external-link">amoeba</a> and <a href="https://stats.stackexchange.com/users/3277/ttnphns" class="external-link">ttnphns</a>, provided theoretical insights and informed design choices. Thomas Lin Pedersen’s <a href="https://github.com/thomasp85/tidygraph" class="external-link"><strong>tidygraph</strong></a> prequel to <strong>ggraph</strong> finally induced the shift from the downstream generation of scatterplots to the upstream handling and manipulating of models. Additional design elements and features have been informed by the monograph <a href="https://www.google.com/books/edition/Biplots/lTxiedIxRpgC" class="external-link"><em>Biplots</em></a> and the textbook <a href="https://www.wiley.com/en-us/Understanding+Biplots-p-9781119972907" class="external-link"><em>Understanding Biplots</em></a> by John C. Gower, David J. Hand, Sugnet Gardner–Lubbe, and Niël J. Le Roux, and by the volume <a href="https://link.springer.com/book/10.1007/b98835" class="external-link"><em>Principal Components Analysis</em></a> by I. T. Jolliffe.</p>
</div>
<div class="section level3">
<h3 id="exposition">exposition<a class="anchor" aria-label="anchor" href="#exposition"></a>
</h3>
<p>This work was presented (<a href="https://raw.githubusercontent.com/corybrunson/tidy-factor/main/tidy-factor-x/tidy-factor-x.pdf" class="external-link">slideshow PDF</a>) at an invited panel on <a href="https://ww2.amstat.org/meetings/jsm/2022/onlineprogram/ActivityDetails.cfm?SessionID=222053" class="external-link">New Developments in Graphing Multivariate Data</a> at the <a href="https://ww2.amstat.org/meetings/jsm/2022/" class="external-link">Joint Statistical Meetings</a>, on 2022 August 8 in Washington DC. I’m grateful to Joyce Robbins for the invitation and for organizing such a fun first experience, to Naomi Robbins for chairing the event, and to my co-panelists Ursula Laa and Hengrui Luo for sharing and sparking such exciting ideas and conversations. An update was presented to the <a href="https://teunbrand.github.io/ggplot-extension-club/" class="external-link">ggplot2 extenders</a>, which elicited additional valuable feedback.</p>
</div>
<div class="section level3">
<h3 id="resources">resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h3>
<p>Development of this package benefitted from the use of equipment and the support of colleagues at <a href="https://health.uconn.edu/" class="external-link">UConn Health</a> and at <a href="https://ufhealth.org/" class="external-link">UF Health</a>.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Greenacre MJ (2010) <em>Biplots in Practice</em>. Fundacion BBVA, ISBN: 978-84-923846. <a href="https://www.fbbva.es/microsite/multivariate-statistics/biplots.html" class="external-link uri">https://www.fbbva.es/microsite/multivariate-statistics/biplots.html</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>The term <em>ordination</em> is most prevalent among ecologists; no catch-all term seems to be in common use outside ecology.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>This is not a hard rule: PCA is often used to compress data before clustering, and LDA uses dimension reduction to perform classification tasks.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Regression and clustering models, like classical <a href="https://www.fbbva.es/microsite/multivariate-statistics/" class="external-link">linear regression</a> and <a href="http://joelcadwell.blogspot.com/2015/08/matrix-factorization-comes-in-many.html" class="external-link"><em>k</em>-means</a>, can also be understood as matrix decomposition approximations and even visualized in biplots. Their shared coordinates, which are pre-defined rather than artificial, are the predictor coefficients and the cluster assignments, respectively. Methods for <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">stats::lm()</a></code> and <code><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">stats::kmeans()</a></code>, for example, are implemented for the sake of novelty and instruction, but are not widely used in practice.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Biplot elments must be chosen with care, and it is useful and appropriate that many model-specific biplot methods have limited flexibility. This package adopts the trade-off articulated in <a href="https://www.google.com/books/edition/_/iI1kcgAACAAJ" class="external-link">Wilkinson’s <em>The Grammar of Graphics</em></a> (p. 15): “This system is capable of producing some hideous graphics. There is nothing in its design to prevent its misuse. … This system cannot produce a meaningless graphic, however.”<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>Anderson E (1936) “The Species Problem in Iris”. <em>Annals of the Missouri Botanical Garden</em> <strong>23</strong>(3), 457-469+471-483+485-501+503-509. <a href="https://doi.org/10.2307/2394164" class="external-link uri">https://doi.org/10.2307/2394164</a><a href="#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>The data must be in the form of a data frame that can be understood by the modeling function. Step-by-step methods also exist to build and annotate a ‘tbl_ord’ from a fitted ordination model.<a href="#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p>The radiating text geom, like several other features, is adapted from the <strong>ggbiplot</strong> package.<a href="#fnref8" class="footnote-back">↩︎</a></p></li>
<li id="fn9"><p>This is an experimental feature only available for linear methods, namely eigendecomposition, singular value decomposition, and principal components analysis.<a href="#fnref9" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=ordr" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/corybrunson/ordr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/corybrunson/ordr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ordr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Jason Cory Brunson <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-3126-9494" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>John Gracey <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://cran.r-project.org/package=ordr" class="external-link"><img src="http://www.r-pkg.org/badges/version/ordr" alt="CRAN"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Jason Cory Brunson, John Gracey.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
