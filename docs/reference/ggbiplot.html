<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Biplots following the grammar of graphics — ggbiplot • ordr</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Biplots following the grammar of graphics — ggbiplot"><meta name="description" content="Build a biplot visualization from ordination data wrapped as a
tbl_ord object."><meta property="og:description" content="Build a biplot visualization from ordination data wrapped as a
tbl_ord object."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ordr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/ordr.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/cmds-variables.html">multidimensional scaling of variables</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/corybrunson/ordr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Biplots following the grammar of graphics</h1>
      <small class="dont-index">Source: <a href="https://github.com/corybrunson/ordr/blob/HEAD/R/biplot.r" class="external-link"><code>R/biplot.r</code></a></small>
      <div class="d-none name"><code>ggbiplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Build a biplot visualization from ordination data wrapped as a
<a href="tbl_ord.html">tbl_ord</a> object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ggbiplot</span><span class="op">(</span></span>
<span>  ordination <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  axis.type <span class="op">=</span> <span class="st">"interpolative"</span>,</span>
<span>  xlim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  expand <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  clip <span class="op">=</span> <span class="st">"on"</span>,</span>
<span>  axis.percents <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sec.axes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scale.factor <span class="op">=</span> <span class="st">"inertia"</span>,</span>
<span>  scale_rows <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scale_cols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ord_aes</span><span class="op">(</span><span class="va">ordination</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ordination">ordination<a class="anchor" aria-label="anchor" href="#arg-ordination"></a></dt>
<dd><p>A <a href="tbl_ord.html">tbl_ord</a>.</p></dd>


<dt id="arg-mapping">mapping<a class="anchor" aria-label="anchor" href="#arg-mapping"></a></dt>
<dd><p>List of default aesthetic mappings to use for the biplot. The
default assigns the first two coordinates to the aesthetics <code>x</code> and <code>y</code>.
Other assignments must be supplied in each layer added to the plot.</p></dd>


<dt id="arg-axis-type">axis.type<a class="anchor" aria-label="anchor" href="#arg-axis-type"></a></dt>
<dd><p>Character, partially matched; whether to build an
<code>"interpolative"</code> (the default) or a <code>"predictive"</code> biplot. The latter
requires that <code>x</code> and <code>y</code> are mapped to shared coordinates, that no other
shared coordinates are mapped to, and inertia is conferred entirely onto
one matrix factor. <strong>NB:</strong> This option is only implemented for linear
techniques (ED, SVD, &amp; PCA).</p></dd>


<dt id="arg-xlim-ylim">xlim, ylim<a class="anchor" aria-label="anchor" href="#arg-xlim-ylim"></a></dt>
<dd><p>Limits for the x and y axes.</p></dd>


<dt id="arg-expand">expand<a class="anchor" aria-label="anchor" href="#arg-expand"></a></dt>
<dd><p>If <code>TRUE</code>, the default, adds a small expansion factor to
the limits to ensure that data and axes don't overlap. If <code>FALSE</code>,
limits are taken exactly from the data or <code>xlim</code>/<code>ylim</code>.</p></dd>


<dt id="arg-clip">clip<a class="anchor" aria-label="anchor" href="#arg-clip"></a></dt>
<dd><p>Should drawing be clipped to the extent of the plot panel? A
setting of <code>"on"</code> (the default) means yes, and a setting of <code>"off"</code>
means no. In most cases, the default of <code>"on"</code> should not be changed,
as setting <code>clip = "off"</code> can cause unexpected results. It allows
drawing of data points anywhere on the plot, including in the plot margins. If
limits are set via <code>xlim</code> and <code>ylim</code> and some data points fall outside those
limits, then those data points may show up in places such as the axes, the
legend, the plot title, or the plot margins.</p></dd>


<dt id="arg-axis-percents">axis.percents<a class="anchor" aria-label="anchor" href="#arg-axis-percents"></a></dt>
<dd><p>Whether to concatenate default axis labels with inertia
percentages.</p></dd>


<dt id="arg-sec-axes">sec.axes<a class="anchor" aria-label="anchor" href="#arg-sec-axes"></a></dt>
<dd><p>Matrix factor character to specify a secondary set of axes.</p></dd>


<dt id="arg-scale-factor">scale.factor<a class="anchor" aria-label="anchor" href="#arg-scale-factor"></a></dt>
<dd><p>Either a numeric value, used to scale the secondary axes
against the primary axes, or the name of a harmonizing function (currently
<code>"range"</code> or <code>"inertia"</code>); ignored if <code>sec.axes</code> is not specified.</p></dd>


<dt id="arg-scale-rows-scale-cols">scale_rows, scale_cols<a class="anchor" aria-label="anchor" href="#arg-scale-rows-scale-cols"></a></dt>
<dd><p>Either the character name of a numeric variable
in <code>get_*(ordination)</code> or a numeric vector of length
<code>nrow(get_*(ordination))</code>, used to scale the coordinates of the matrix
factors.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code><a href="https://ggplot2.tidyverse.org/reference/fortify.html" class="external-link">ggplot2::fortify()</a></code>; see
<code><a href="tidiers.html">fortify.tbl_ord()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a> object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>ggbiplot()</code> produces a <a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a> object from a <a href="tbl_ord.html">tbl_ord</a>
object <code>ordination</code>. The baseline object is the default unadorned
<code>"ggplot"</code>-class object <code>p</code> with the following differences from what
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code> returns:</p><ul><li><p><code>p$mapping</code> is augmented with <code>.matrix = .matrix</code>, which expects either
<code>.matrix = "rows"</code> or <code>.matrix = "cols"</code> from the biplot.</p></li>
<li><p><code>p$coordinates</code> is defaulted to <code><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">ggplot2::coord_equal()</a></code> in order to
faithfully render the geometry of an ordination. The optional parameters
<code>xlim</code>, <code>ylim</code>, <code>expand</code>, and <code>clip</code> are passed to <code><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal()</a></code> and
default to its <strong>ggplot2</strong> defaults.</p></li>
<li><p>When <code>x</code> or <code>y</code> are mapped to coordinates of <code>ordination</code>, and if
<code>axis.percents</code> is <code>TRUE</code>, <code>p$labels$x</code> or <code>p$labels$y</code> are defaulted to the
coordinate names concatenated with the percentages of <a href="conference.html">inertia</a>
captured by the coordinates.</p></li>
<li><p><code>p</code> is assigned the class <code>"ggbiplot"</code> in addition to <code>"ggplot"</code>. This
serves no functional purpose currently.</p></li>
</ul><p>Furthermore, the user may feed single integer values to the <code>x</code> and <code>y</code>
aesthetics, which will be interpreted as the corresponding coordinates in the
ordination. Currently only 2-dimensional biplots are supported, so both <code>x</code>
and <code>y</code> must take coordinate values.</p>
<p><code>ord_aes()</code> is a convenience function that generates a full-rank set of
coordinate aesthetics <code>..coord1</code>, <code>..coord2</code>, etc. mapped to the shared
coordinates of the ordination object, along with any additional aesthetics
that are processed internally by <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">ggplot2::aes()</a></code>.</p>
<p>The <code>axis.type</code> parameter controls whether the biplot is interpolative or
predictive, though predictive biplots are still experimental and limited to
linear methods like PCA. Gower &amp; Hand (1996) and Gower, Gardner–Lubbe, &amp; le
Roux (2011) thoroughly explain the construction and interpretation of
predictive biplots.</p>
    </div>
    <div class="section level2">
    <h2 id="biplot-layers">Biplot layers<a class="anchor" aria-label="anchor" href="#biplot-layers"></a></h2>


<p><code>ggbiplot()</code> uses <code><a href="https://ggplot2.tidyverse.org/reference/fortify.html" class="external-link">ggplot2::fortify()</a></code> internally to produce a single data
frame with a <code>.matrix</code> column distinguishing the subjects (<code>"rows"</code>) and
variables (<code>"cols"</code>). The stat layers <code><a href="stat_rows.html">stat_rows()</a></code> and <code><a href="stat_rows.html">stat_cols()</a></code> simply
filter the data frame to one of these two.</p>
<p>The geom layers <code>geom_rows_*()</code> and <code>geom_cols_*()</code> call the corresponding
stat in order to render plot elements for the corresponding factor matrix.
<code>geom_dims_*()</code> selects a default matrix based on common practice, e.g.
points for rows and arrows for columns.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Gower JC &amp; Hand DJ (1996) <em>Biplots</em>. Chapman &amp; Hall, ISBN: 0-412-71630-5.</p>
<p>Gower JC, Gardner–Lubbe S, &amp; le Roux NJ (2011) <em>Understanding Biplots</em>.
Wiley, ISBN: 978-0-470-01255-0. <a href="https://www.wiley.com/go/biplots" class="external-link">https://www.wiley.com/go/biplots</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://ggplot2.tidyverse.org/reference/ggplot2-package.html" class="external-link">ggplot2::ggplot2()</a></code>, on which <code>ggbiplot()</code> is built</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># compute PCA of Anderson iris measurements</span></span></span>
<span class="r-in"><span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/princomp.html" class="external-link">princomp</a></span><span class="op">(</span>cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tbl_ord.html">as_tbl_ord</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="conference.html">confer_inertia</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="dplyr-verbs.html">mutate_rows</a></span><span class="op">(</span>species <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="dplyr-verbs.html">mutate_cols</a></span><span class="op">(</span>measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\."</span>, <span class="st">" "</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">iris_pca</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # A tbl_ord of class 'princomp': (150 x 4) x (4 x 4)'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # 4 coordinates: Comp.1, Comp.2, ..., Comp.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Rows (principal): [ 150 x 4 | 1 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Comp.1 Comp.2  Comp.3 ... |   species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             |   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  -<span style="color: #BB0000;">2.26</span>  0.480  0.128      | <span style="color: #BCBCBC;">1</span> setosa </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>  -<span style="color: #BB0000;">2.08</span> -<span style="color: #BB0000;">0.674</span>  0.235      | <span style="color: #BCBCBC;">2</span> setosa </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>  -<span style="color: #BB0000;">2.36</span> -<span style="color: #BB0000;">0.342</span> -<span style="color: #BB0000;">0.044</span><span style="color: #BB0000; text-decoration: underline;">2</span> ... | <span style="color: #BCBCBC;">3</span> setosa </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>  -<span style="color: #BB0000;">2.30</span> -<span style="color: #BB0000;">0.597</span> -<span style="color: #BB0000;">0.091</span><span style="color: #BB0000; text-decoration: underline;">3</span>     | <span style="color: #BCBCBC;">4</span> setosa </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>  -<span style="color: #BB0000;">2.39</span>  0.647 -<span style="color: #BB0000;">0.015</span><span style="color: #BB0000; text-decoration: underline;">7</span>     | <span style="color: #BCBCBC;">5</span> setosa </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 145 more rows</span>     | <span style="color: #949494;"># ℹ 145 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Columns (standard): [ 4 x 4 | 1 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Comp.1 Comp.2 Comp.3 ... |   measure     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            |   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  0.521 0.377   0.720     | <span style="color: #BCBCBC;">1</span> sepal length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">0.269</span> 0.923  -<span style="color: #BB0000;">0.244</span> ... | <span style="color: #BCBCBC;">2</span> sepal width </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>  0.580 0.024<span style="text-decoration: underline;">5</span> -<span style="color: #BB0000;">0.142</span>     | <span style="color: #BCBCBC;">3</span> petal length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>  0.565 0.066<span style="text-decoration: underline;">9</span> -<span style="color: #BB0000;">0.634</span>     | <span style="color: #BCBCBC;">4</span> petal width </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># row-principal biplot with range-harmonized secondary axis</span></span></span>
<span class="r-in"><span><span class="va">iris_pca</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">ggbiplot</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">species</span><span class="op">)</span>, sec.axes <span class="op">=</span> <span class="st">"cols"</span>, scale.factor <span class="op">=</span> <span class="st">"range"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"qual"</span>, palette <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_cols_vector</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">measure</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#444444"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"Row-principal PCA biplot of Anderson iris measurements"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Variable loadings scaled to secondary axes"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">3.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ggbiplot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># row-principal biplot with manually rescaled secondary axis</span></span></span>
<span class="r-in"><span><span class="va">iris_pca</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">ggbiplot</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">species</span><span class="op">)</span>, sec.axes <span class="op">=</span> <span class="st">"cols"</span>, scale.factor <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"qual"</span>, palette <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_cols_vector</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">measure</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#444444"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"Row-principal PCA biplot of Anderson iris measurements"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Variable loadings scaled to secondary axes"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">3.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ggbiplot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Performance measures can be regressed on the artificial coordinates of</span></span></span>
<span class="r-in"><span><span class="co"># ordinated vehicle specs. Because the ordination of specs ignores performance,</span></span></span>
<span class="r-in"><span><span class="co"># these coordinates will probably not be highly predictive. The gradient of each</span></span></span>
<span class="r-in"><span><span class="co"># performance measure along the artificial axes is visualized by projecting the</span></span></span>
<span class="r-in"><span><span class="co"># regression coefficients onto the ordination biplot.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># scaled principal components analysis of vehicle specs</span></span></span>
<span class="r-in"><span><span class="va">mtcars_specs_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="ordinate.html">ordinate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">mtcars</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cyl</span>, <span class="va">disp</span>, <span class="va">hp</span>, <span class="va">drat</span>, <span class="va">wt</span>, <span class="va">vs</span>, <span class="va">carb</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/princomp.html" class="external-link">princomp</a></span><span class="op">(</span><span class="va">.</span>, cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># data frame of vehicle performance measures</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">qsec</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">mtcars_perf</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      mpg  qsec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4           21.0 16.46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag       21.0 17.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710          22.8 18.61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive      21.4 19.44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout   18.7 17.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Valiant             18.1 20.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Duster 360          14.3 15.84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 240D           24.4 20.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 230            22.8 22.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 280            19.2 18.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 280C           17.8 18.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 450SE          16.4 17.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 450SL          17.3 17.60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 450SLC         15.2 18.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cadillac Fleetwood  10.4 17.98</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lincoln Continental 10.4 17.82</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chrysler Imperial   14.7 17.42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fiat 128            32.4 19.47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Honda Civic         30.4 18.52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Toyota Corolla      33.9 19.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Toyota Corona       21.5 20.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dodge Challenger    15.5 16.87</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AMC Javelin         15.2 17.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Camaro Z28          13.3 15.41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pontiac Firebird    19.2 17.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fiat X1-9           27.3 18.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Porsche 914-2       26.0 16.70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lotus Europa        30.4 16.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ford Pantera L      15.8 14.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ferrari Dino        19.7 15.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maserati Bora       15.0 14.60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Volvo 142E          21.4 18.60</span>
<span class="r-in"><span><span class="co"># regress performance measures on principal components</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mtcars_perf</span> <span class="op">~</span> <span class="fu"><a href="recoverers.html">get_rows</a></span><span class="op">(</span><span class="va">mtcars_specs_pca</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tbl_ord.html">as_tbl_ord</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="augmentation.html">augment_ord</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">mtcars_pca_lm</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # A tbl_ord of class 'mlm': (32 x 8) x (2 x 8)'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # 8 coordinates: (Intercept), Comp.1, ..., Comp.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Rows: [ 32 x 8 | 1 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   `(Intercept)` Comp.1 Comp.2 ... |   name             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                   |   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>             1 -<span style="color: #BB0000;">0.398</span> -<span style="color: #BB0000;">1.12</span>      | <span style="color: #BCBCBC;">1</span> Mazda RX4        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>             1 -<span style="color: #BB0000;">0.294</span> -<span style="color: #BB0000;">1.06</span>      | <span style="color: #BCBCBC;">2</span> Mazda RX4 Wag    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>             1 -<span style="color: #BB0000;">2.54</span>   0.465 ... | <span style="color: #BCBCBC;">3</span> Datsun 710       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>             1 -<span style="color: #BB0000;">0.601</span>  1.75      | <span style="color: #BCBCBC;">4</span> Hornet 4 Drive   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>             1  1.61   0.837     | <span style="color: #BCBCBC;">5</span> Hornet Sportabout</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 27 more rows</span>     | <span style="color: #949494;"># ℹ 27 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Columns: [ 2 x 8 | 1 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   `(Intercept)` Comp.1 Comp.2 ... |   name </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                   |   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>          20.1 -<span style="color: #BB0000;">2.41</span>  -<span style="color: #BB0000;">0.415</span> ... | <span style="color: #BCBCBC;">1</span> mpg  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>          17.8 -<span style="color: #BB0000;">0.459</span>  0.929     | <span style="color: #BCBCBC;">2</span> qsec </span>
<span class="r-in"><span><span class="co"># regression biplot</span></span></span>
<span class="r-in"><span><span class="fu">ggbiplot</span><span class="op">(</span><span class="va">mtcars_specs_pca</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         sec.axes <span class="op">=</span> <span class="st">"rows"</span>, scale.factor <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_cols_vector</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mtcars_pca_lm</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ggbiplot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># multidimensional scaling based on a scaled cosine distance of vehicle specs</span></span></span>
<span class="r-in"><span><span class="va">cosine_dist</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">num</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">denom_rt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">denom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">denom_rt</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">denom_rt</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">num</span> <span class="op">/</span> <span class="va">denom</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cyl</span>, <span class="va">disp</span>, <span class="va">hp</span>, <span class="va">drat</span>, <span class="va">wt</span>, <span class="va">vs</span>, <span class="va">carb</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">cosine_dist</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span></span></span>
<span class="r-in"><span>  <span class="va">mtcars_specs_cmds</span></span></span>
<span class="r-in"><span><span class="co"># names must be consistent with `cmdscale_ord()` below</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mtcars_specs_cmds</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PCo1"</span>, <span class="st">"PCo2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># regress performance measures on principal coordinates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mtcars_perf</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">mtcars_specs_cmds</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tbl_ord.html">as_tbl_ord</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="augmentation.html">augment_ord</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">mtcars_cmds_lm</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # A tbl_ord of class 'mlm': (32 x 3) x (2 x 3)'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # 3 coordinates: (Intercept), PCo1, PCo2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Rows: [ 32 x 3 | 1 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   `(Intercept)`   PCo1   PCo2 |   name             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                               |   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>             1 -<span style="color: #BB0000;">0.238</span> -<span style="color: #BB0000;">0.666</span> | <span style="color: #BCBCBC;">1</span> Mazda RX4        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>             1 -<span style="color: #BB0000;">0.190</span> -<span style="color: #BB0000;">0.685</span> | <span style="color: #BCBCBC;">2</span> Mazda RX4 Wag    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>             1 -<span style="color: #BB0000;">0.934</span>  0.224 | <span style="color: #BCBCBC;">3</span> Datsun 710       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>             1 -<span style="color: #BB0000;">0.247</span>  0.984 | <span style="color: #BCBCBC;">4</span> Hornet 4 Drive   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>             1  0.834  0.316 | <span style="color: #BCBCBC;">5</span> Hornet Sportabout</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 27 more rows</span> | <span style="color: #949494;"># ℹ 27 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Columns: [ 2 x 3 | 1 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   `(Intercept)`  PCo1  PCo2 |   name </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             |   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>          20.1 -<span style="color: #BB0000;">6.19</span> 0.160 | <span style="color: #BCBCBC;">1</span> mpg  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>          17.8 -<span style="color: #BB0000;">1.31</span> 2.38  | <span style="color: #BCBCBC;">2</span> qsec </span>
<span class="r-in"><span><span class="co"># multidimensional scaling using `cmdscale_ord()`</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cyl</span>, <span class="va">disp</span>, <span class="va">hp</span>, <span class="va">drat</span>, <span class="va">wt</span>, <span class="va">vs</span>, <span class="va">carb</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">cosine_dist</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="wrap-ord.html">cmdscale_ord</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tbl_ord.html">as_tbl_ord</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="augmentation.html">augment_ord</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">mtcars_specs_cmds_ord</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # A tbl_ord of class 'cmds_ord': (32 x 2) x (32 x 2)'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # 2 coordinates: PCo1 and PCo2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Rows (symmetric): [ 32 x 2 | 1 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     PCo1   PCo2 |   name             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 |   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">0.238</span> -<span style="color: #BB0000;">0.666</span> | <span style="color: #BCBCBC;">1</span> Mazda RX4        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">0.190</span> -<span style="color: #BB0000;">0.685</span> | <span style="color: #BCBCBC;">2</span> Mazda RX4 Wag    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.934</span>  0.224 | <span style="color: #BCBCBC;">3</span> Datsun 710       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> -<span style="color: #BB0000;">0.247</span>  0.984 | <span style="color: #BCBCBC;">4</span> Hornet 4 Drive   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>  0.834  0.316 | <span style="color: #BCBCBC;">5</span> Hornet Sportabout</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 27 more rows</span> | <span style="color: #949494;"># ℹ 27 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Columns (symmetric): [ 32 x 2 | 1 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     PCo1   PCo2 |   name             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 |   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">0.238</span> -<span style="color: #BB0000;">0.666</span> | <span style="color: #BCBCBC;">1</span> Mazda RX4        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">0.190</span> -<span style="color: #BB0000;">0.685</span> | <span style="color: #BCBCBC;">2</span> Mazda RX4 Wag    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.934</span>  0.224 | <span style="color: #BCBCBC;">3</span> Datsun 710       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> -<span style="color: #BB0000;">0.247</span>  0.984 | <span style="color: #BCBCBC;">4</span> Hornet 4 Drive   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>  0.834  0.316 | <span style="color: #BCBCBC;">5</span> Hornet Sportabout</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 27 more rows</span> | <span style="color: #949494;"># ℹ 27 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># regression biplot</span></span></span>
<span class="r-in"><span><span class="fu">ggbiplot</span><span class="op">(</span><span class="va">mtcars_specs_cmds_ord</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         sec.axes <span class="op">=</span> <span class="st">"rows"</span>, scale.factor <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_cols_vector</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mtcars_cmds_lm</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.25</span>, <span class="fl">1.25</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ggbiplot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># PCA of iris data</span></span></span>
<span class="r-in"><span><span class="va">iris_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="ordinate.html">ordinate</a></span><span class="op">(</span><span class="va">iris</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="va">prcomp</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># row-principal predictive biplot</span></span></span>
<span class="r-in"><span><span class="va">iris_pca</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">ggbiplot</span><span class="op">(</span>axis.type <span class="op">=</span> <span class="st">"predictive"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"qual"</span>, palette <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_cols_axis</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span>, center <span class="op">=</span> <span class="va">center</span>, scale <span class="op">=</span> <span class="va">scale</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Predictive biplot of Anderson iris measurements"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ggbiplot-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># with two calibrated axes</span></span></span>
<span class="r-in"><span><span class="va">iris_pca</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">ggbiplot</span><span class="op">(</span>axis.type <span class="op">=</span> <span class="st">"predictive"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"qual"</span>, palette <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="geom_origin.html">geom_origin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-stats.html">stat_cols_rule</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, fontface <span class="op">=</span> <span class="st">"bold"</span>, text.fontface <span class="op">=</span> <span class="st">"plain"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span>, center <span class="op">=</span> <span class="va">center</span>, scale <span class="op">=</span> <span class="va">scale</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Predictive biplot of Anderson iris measurements"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ggbiplot-6.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jason Cory Brunson, John Gracey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

