<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Convenience stats for row and column matrix factors — biplot-stats • ordr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Convenience stats for row and column matrix factors — biplot-stats"><meta name="description" content="These statistical transformations (stats) adapt
conventional ggplot2 stats to one or the other matrix factor
of a tbl_ord, in lieu of stat_rows() or stat_cols(). They
accept the same parameters as their corresponding conventional
stats."><meta property="og:description" content="These statistical transformations (stats) adapt
conventional ggplot2 stats to one or the other matrix factor
of a tbl_ord, in lieu of stat_rows() or stat_cols(). They
accept the same parameters as their corresponding conventional
stats."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ordr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2.0003</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/ordr.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/cmds-variables.html">multidimensional scaling of variables</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/corybrunson/ordr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Convenience stats for row and column matrix factors</h1>
      <small class="dont-index">Source: <a href="https://github.com/corybrunson/ordr/blob/HEAD/R/zzz-biplot-stats.r" class="external-link"><code>R/zzz-biplot-stats.r</code></a></small>
      <div class="d-none name"><code>biplot-stats.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These statistical transformations (stats) adapt
conventional <strong>ggplot2</strong> stats to one or the other matrix factor
of a tbl_ord, in lieu of <code><a href="stat_rows.html">stat_rows()</a></code> or <code><a href="stat_rows.html">stat_cols()</a></code>. They
accept the same parameters as their corresponding conventional
stats.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stat_rows_density_2d</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"density_2d"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  contour <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  contour_var <span class="op">=</span> <span class="st">"density"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  h <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  adjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_cols_density_2d</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"density_2d"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  contour <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  contour_var <span class="op">=</span> <span class="st">"density"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  h <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  adjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_rows_density_2d_filled</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"density_2d_filled"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  contour <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  contour_var <span class="op">=</span> <span class="st">"density"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  h <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  adjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_cols_density_2d_filled</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"density_2d_filled"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  contour <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  contour_var <span class="op">=</span> <span class="st">"density"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  h <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  adjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_rows_ellipse</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"path"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"t"</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  segments <span class="op">=</span> <span class="fl">51</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_cols_ellipse</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"path"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"t"</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  segments <span class="op">=</span> <span class="fl">51</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_rows_center</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  fun.data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun.center <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun.min <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun.max <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun.ord <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_cols_center</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  fun.data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun.center <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun.min <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun.max <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun.ord <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_rows_star</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"segment"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  fun.data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun.center <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun.ord <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_cols_star</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"segment"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  fun.data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun.center <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun.ord <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_rows_chull</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"polygon"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_cols_chull</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"polygon"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_rows_peel</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"polygon"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  num <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  cut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"above"</span>, <span class="st">"below"</span><span class="op">)</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_cols_peel</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"polygon"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  num <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  cut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"above"</span>, <span class="st">"below"</span><span class="op">)</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_rows_cone</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"path"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  origin <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_cols_cone</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"path"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  origin <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_rows_depth</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"contour"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  contour <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  contour_var <span class="op">=</span> <span class="st">"depth"</span>,</span>
<span>  notion <span class="op">=</span> <span class="st">"zonoid"</span>,</span>
<span>  notion_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_cols_depth</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"contour"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  contour <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  contour_var <span class="op">=</span> <span class="st">"depth"</span>,</span>
<span>  notion <span class="op">=</span> <span class="st">"zonoid"</span>,</span>
<span>  notion_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_rows_depth_filled</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"contour_filled"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  contour <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  contour_var <span class="op">=</span> <span class="st">"depth"</span>,</span>
<span>  notion <span class="op">=</span> <span class="st">"zonoid"</span>,</span>
<span>  notion_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_cols_depth_filled</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"contour_filled"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  contour <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  contour_var <span class="op">=</span> <span class="st">"depth"</span>,</span>
<span>  notion <span class="op">=</span> <span class="st">"zonoid"</span>,</span>
<span>  notion_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_rows_scale</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  mult <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_cols_scale</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  mult <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_rows_spantree</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"segment"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  engine <span class="op">=</span> <span class="st">"mlpack"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_cols_spantree</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"segment"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  engine <span class="op">=</span> <span class="st">"mlpack"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_rows_bagplot</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"bagplot"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  fraction <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  coef <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  median <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fence <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  outliers <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_cols_bagplot</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"bagplot"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  fraction <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  coef <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  median <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fence <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  outliers <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_rows_rule</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"rule"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  fun.lower <span class="op">=</span> <span class="st">"minpp"</span>,</span>
<span>  fun.upper <span class="op">=</span> <span class="st">"maxpp"</span>,</span>
<span>  fun.offset <span class="op">=</span> <span class="st">"minabspp"</span>,</span>
<span>  fun.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  referent <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ref_subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ref_elements <span class="op">=</span> <span class="st">"active"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_cols_rule</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"rule"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  fun.lower <span class="op">=</span> <span class="st">"minpp"</span>,</span>
<span>  fun.upper <span class="op">=</span> <span class="st">"maxpp"</span>,</span>
<span>  fun.offset <span class="op">=</span> <span class="st">"minabspp"</span>,</span>
<span>  fun.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  referent <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ref_subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ref_elements <span class="op">=</span> <span class="st">"active"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_rows_projection</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"segment"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  referent <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ref_subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ref_elements <span class="op">=</span> <span class="st">"active"</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stat_cols_projection</span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"segment"</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  referent <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ref_subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ref_elements <span class="op">=</span> <span class="st">"active"</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  show.legend <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mapping">mapping<a class="anchor" aria-label="anchor" href="#arg-mapping"></a></dt>
<dd><p>Set of aesthetic mappings created by <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code>. If specified and
<code>inherit.aes = TRUE</code> (the default), it is combined with the default mapping
at the top level of the plot. You must supply <code>mapping</code> if there is no plot
mapping.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>The data to be displayed in this layer. There are three
options:</p>
<p>If <code>NULL</code>, the default, the data is inherited from the plot
data as specified in the call to <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code>.</p>
<p>A <code>data.frame</code>, or other object, will override the plot
data. All objects will be fortified to produce a data frame. See
<code><a href="https://ggplot2.tidyverse.org/reference/fortify.html" class="external-link">fortify()</a></code> for which variables will be created.</p>
<p>A <code>function</code> will be called with a single argument,
the plot data. The return value must be a <code>data.frame</code>, and
will be used as the layer data. A <code>function</code> can be created
from a <code>formula</code> (e.g. <code>~ head(.x, 10)</code>).</p></dd>


<dt id="arg-geom">geom<a class="anchor" aria-label="anchor" href="#arg-geom"></a></dt>
<dd><p>The geometric object to use to display the data for this layer.
When using a <code>stat_*()</code> function to construct a layer, the <code>geom</code> argument
can be used to override the default coupling between stats and geoms. The
<code>geom</code> argument accepts the following:</p><ul><li><p>A <code>Geom</code> ggproto subclass, for example <code>GeomPoint</code>.</p></li>
<li><p>A string naming the geom. To give the geom as a string, strip the
function name of the <code>geom_</code> prefix. For example, to use <code>geom_point()</code>,
give the geom as <code>"point"</code>.</p></li>
<li><p>For more information and other ways to specify the geom, see the
<a href="https://ggplot2.tidyverse.org/reference/layer_geoms.html" class="external-link">layer geom</a> documentation.</p></li>
</ul></dd>


<dt id="arg-position">position<a class="anchor" aria-label="anchor" href="#arg-position"></a></dt>
<dd><p>A position adjustment to use on the data for this layer. This
can be used in various ways, including to prevent overplotting and
improving the display. The <code>position</code> argument accepts the following:</p><ul><li><p>The result of calling a position function, such as <code>position_jitter()</code>.
This method allows for passing extra arguments to the position.</p></li>
<li><p>A string naming the position adjustment. To give the position as a
string, strip the function name of the <code>position_</code> prefix. For example,
to use <code>position_jitter()</code>, give the position as <code>"jitter"</code>.</p></li>
<li><p>For more information and other ways to specify the position, see the
<a href="https://ggplot2.tidyverse.org/reference/layer_positions.html" class="external-link">layer position</a> documentation.</p></li>
</ul></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code><a href="https://ggplot2.tidyverse.org/reference/layer.html" class="external-link">ggplot2::layer()</a></code>.</p></dd>


<dt id="arg-contour">contour<a class="anchor" aria-label="anchor" href="#arg-contour"></a></dt>
<dd><p>If <code>TRUE</code>, contour the results of the 2d density
estimation.</p></dd>


<dt id="arg-contour-var">contour_var<a class="anchor" aria-label="anchor" href="#arg-contour-var"></a></dt>
<dd><p>Character string identifying the variable to contour
by. Can be one of <code>"density"</code>, <code>"ndensity"</code>, or <code>"count"</code>. See the section
on computed variables for details.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Number of grid points in each direction.</p></dd>


<dt id="arg-h">h<a class="anchor" aria-label="anchor" href="#arg-h"></a></dt>
<dd><p>Bandwidth (vector of length two). If <code>NULL</code>, estimated
using <code><a href="https://rdrr.io/pkg/MASS/man/bandwidth.nrd.html" class="external-link">MASS::bandwidth.nrd()</a></code>.</p></dd>


<dt id="arg-adjust">adjust<a class="anchor" aria-label="anchor" href="#arg-adjust"></a></dt>
<dd><p>A multiplicative bandwidth adjustment to be used if 'h' is
'NULL'. This makes it possible to adjust the bandwidth while still
using the a bandwidth estimator. For example, <code>adjust = 1/2</code> means
use half of the default bandwidth.</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>If <code>FALSE</code>, the default, missing values are removed with
a warning. If <code>TRUE</code>, missing values are silently removed.</p></dd>


<dt id="arg-show-legend">show.legend<a class="anchor" aria-label="anchor" href="#arg-show-legend"></a></dt>
<dd><p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.
It can also be a named logical vector to finely select the aesthetics to
display.</p></dd>


<dt id="arg-inherit-aes">inherit.aes<a class="anchor" aria-label="anchor" href="#arg-inherit-aes"></a></dt>
<dd><p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="https://ggplot2.tidyverse.org/reference/borders.html" class="external-link">borders()</a></code>.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>The type of ellipse.
The default <code>"t"</code> assumes a multivariate t-distribution, and
<code>"norm"</code> assumes a multivariate normal distribution.
<code>"euclid"</code> draws a circle with the radius equal to <code>level</code>,
representing the euclidean distance from the center.
This ellipse probably won't appear circular unless <code>coord_fixed()</code> is applied.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>The level at which to draw an ellipse,
or, if <code>type="euclid"</code>, the radius of the circle to be drawn.</p></dd>


<dt id="arg-segments">segments<a class="anchor" aria-label="anchor" href="#arg-segments"></a></dt>
<dd><p>The number of segments to be used in drawing the ellipse.</p></dd>


<dt id="arg-fun-data">fun.data<a class="anchor" aria-label="anchor" href="#arg-fun-data"></a></dt>
<dd><p>A function that is given the complete data and should
return a data frame with variables <code>ymin</code>, <code>y</code>, and <code>ymax</code>.</p></dd>


<dt id="arg-fun-center">fun.center<a class="anchor" aria-label="anchor" href="#arg-fun-center"></a></dt>
<dd><p>Deprecated alias to <code>fun</code>.</p></dd>


<dt id="arg-fun-min-fun-fun-max">fun.min, fun, fun.max<a class="anchor" aria-label="anchor" href="#arg-fun-min-fun-fun-max"></a></dt>
<dd><p>Alternatively, supply three individual
functions that are each passed a vector of values and should return a
single number.</p></dd>


<dt id="arg-fun-ord">fun.ord<a class="anchor" aria-label="anchor" href="#arg-fun-ord"></a></dt>
<dd><p>Alternatively to the <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">ggplot2::stat_summary_bin()</a></code> parameters,
supply a summary function that takes a matrix as input and returns a named
column summary vector. Overridden by <code>fun.data</code> and <code>fun</code>, cannot be used
together with <code>fun.min</code> and <code>fun.max</code>.</p></dd>


<dt id="arg-fun-args">fun.args<a class="anchor" aria-label="anchor" href="#arg-fun-args"></a></dt>
<dd><p>Optional additional arguments passed on to the functions.</p></dd>


<dt id="arg-num">num<a class="anchor" aria-label="anchor" href="#arg-num"></a></dt>
<dd><p>A positive integer; the number of hulls to peel. Pass <code>Inf</code> for
all hulls.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>A positive integer; with what frequency to include consecutive
hulls, pairs with <code>num</code>.</p></dd>


<dt id="arg-breaks">breaks<a class="anchor" aria-label="anchor" href="#arg-breaks"></a></dt>
<dd><p>A numeric vector of fractions (between <code>0</code> and <code>1</code>) of the data
to contain in each hull; overridden by <code>num</code>.</p></dd>


<dt id="arg-cut">cut<a class="anchor" aria-label="anchor" href="#arg-cut"></a></dt>
<dd><p>Character; one of <code>"above"</code> and <code>"below"</code>, indicating whether each
hull should contain at least or at most <code>breaks</code> of the data, respectively.</p></dd>


<dt id="arg-origin">origin<a class="anchor" aria-label="anchor" href="#arg-origin"></a></dt>
<dd><p>Logical; whether to include the origin with the transformed
data. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-notion">notion<a class="anchor" aria-label="anchor" href="#arg-notion"></a></dt>
<dd><p>Character; the name of the depth function (passed to
<code><a href="https://rdrr.io/pkg/ddalpha/man/depth..html" class="external-link">ddalpha::depth.()</a></code>).</p></dd>


<dt id="arg-notion-params">notion_params<a class="anchor" aria-label="anchor" href="#arg-notion-params"></a></dt>
<dd><p>List of additional parameters passed via <code>...</code> to
<code><a href="https://rdrr.io/pkg/ddalpha/man/depth..html" class="external-link">ddalpha::depth.()</a></code>.</p></dd>


<dt id="arg-mult">mult<a class="anchor" aria-label="anchor" href="#arg-mult"></a></dt>
<dd><p>Numeric value used to scale the coordinates.</p></dd>


<dt id="arg-engine">engine<a class="anchor" aria-label="anchor" href="#arg-engine"></a></dt>
<dd><p>A single character string specifying the package implementation
to use; <code>"mlpack"</code>, <code>"vegan"</code>, or <code>"ade4"</code>.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Passed to <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">stats::dist()</a></code> if <code>engine</code> is <code>"vegan"</code> or <code>"ade4"</code>,
ignored if <code>"mlpack"</code>.</p></dd>


<dt id="arg-fraction">fraction<a class="anchor" aria-label="anchor" href="#arg-fraction"></a></dt>
<dd><p>Fraction of the data to include in the bag.</p></dd>


<dt id="arg-coef">coef<a class="anchor" aria-label="anchor" href="#arg-coef"></a></dt>
<dd><p>Scale factor of the fence relative to the bag.</p></dd>


<dt id="arg-median-fence-outliers">median, fence, outliers<a class="anchor" aria-label="anchor" href="#arg-median-fence-outliers"></a></dt>
<dd><p>Logical indicators whether to include median,
fence, and outliers in the composite output.</p></dd>


<dt id="arg-fun-lower-fun-upper-fun-offset">fun.lower, fun.upper, fun.offset<a class="anchor" aria-label="anchor" href="#arg-fun-lower-fun-upper-fun-offset"></a></dt>
<dd><p>Functions used to determine the limits
of the rules and the translations of the axes from the projections of
<code>referent</code> onto the axes and onto their normal vectors.</p></dd>


<dt id="arg-referent">referent<a class="anchor" aria-label="anchor" href="#arg-referent"></a></dt>
<dd><p>The reference data set; see Details.</p></dd>


<dt id="arg-ref-elements-ref-subset">ref_elements, ref_subset<a class="anchor" aria-label="anchor" href="#arg-ref-elements-ref-subset"></a></dt>
<dd><p>Analogues of <code>elements</code> and <code>subset</code> applied
to <code>referent</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggproto <a href="https://ggplot2.tidyverse.org/reference/layer.html" class="external-link">layer</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="ordination-aesthetics">Ordination aesthetics<a class="anchor" aria-label="anchor" href="#ordination-aesthetics"></a></h2>


<p>This statistical transformation is compatible with the convenience function
<code><a href="ggbiplot.html">ord_aes()</a></code>.</p>
<p>Some transformations (e.g. <code><a href="https://corybrunson.github.io/gggda/reference/stat_center.html" class="external-link">stat_center()</a></code>) commute with projection to the
lower (1 or 2)-dimensional biplot space. If they detect aesthetics of the
form <code>..coord[0-9]+</code>, then <code>..coord1</code> and <code>..coord2</code> are converted to <code>x</code> and
<code>y</code> while any remaining are ignored.</p>
<p>Other transformations (e.g. <code><a href="https://corybrunson.github.io/gggda/reference/stat_spantree.html" class="external-link">stat_spantree()</a></code>) yield different results in a
lower-dimensional biplot when they are computed before versus after
projection. If the stat layer detects these aesthetics, then the
transformation is performed before projection, and the results in the first
two dimensions are returned as <code>x</code> and <code>y</code>.</p>
<p>A small number of transformations (<code><a href="https://corybrunson.github.io/gggda/reference/stat_rule.html" class="external-link">stat_rule()</a></code>) are incompatible with
ordination aesthetics but will accept <code><a href="ggbiplot.html">ord_aes()</a></code> without warning.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other biplot layers:
<code><a href="biplot-geoms.html">biplot-geoms</a></code>,
<code><a href="stat_rows.html">stat_rows</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">iris_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="ordinate.html">ordinate</a></span><span class="op">(</span><span class="va">iris</span>, <span class="va">prcomp</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>, scale. <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># NB: Non-standard aesthetics are handled as in version &gt; 3.5.1; see:</span></span></span>
<span class="r-in"><span><span class="co"># https://github.com/tidyverse/ggplot2/issues/6191</span></span></span>
<span class="r-in"><span><span class="co"># This prevents `scale_color_discrete(aesthetics = ...)` from synching them.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="va">iris_pca</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">stat_rows_bagplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    median_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="sync.html">sync</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    fence_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    outlier_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="st">"asterisk"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">scale_color_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Species"</span>, aesthetics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"color"</span>, <span class="st">"fill"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_cols_vector</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="biplot-stats-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="va">iris_pca</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">stat_rows_bagplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Species</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    median_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="sync.html">sync</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    fence_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    outlier_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="st">"asterisk"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_cols_vector</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="biplot-stats-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">USJudgeRatings</span> <span class="op">|&gt;</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="ordinate.html">ordinate</a></span><span class="op">(</span><span class="va">prcomp</span><span class="op">)</span> <span class="op">|&gt;</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="dplyr-verbs.html">mutate_rows</a></span><span class="op">(</span>surname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"(,|\\.).*$"</span>, <span class="st">""</span>, <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span></span></span>
<span class="r-in"><span>  <span class="va">judges_pca</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="va">judges_pca</span>, sec.axes <span class="op">=</span> <span class="st">"cols"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_bagplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_text</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">surname</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_cols_vector</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="biplot-stats-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># scaled PCA of Anderson iris measurements</span></span></span>
<span class="r-in"><span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/princomp.html" class="external-link">princomp</a></span><span class="op">(</span>cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tbl_ord.html">as_tbl_ord</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="dplyr-verbs.html">mutate_rows</a></span><span class="op">(</span>species <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">iris_pca</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # A tbl_ord of class 'princomp': (150 x 4) x (4 x 4)'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # 4 coordinates: Comp.1, Comp.2, ..., Comp.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Rows (principal): [ 150 x 4 | 1 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Comp.1 Comp.2  Comp.3 ... |   species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             |   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  -<span style="color: #BB0000;">2.26</span>  0.480  0.128      | <span style="color: #BCBCBC;">1</span> setosa </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>  -<span style="color: #BB0000;">2.08</span> -<span style="color: #BB0000;">0.674</span>  0.235      | <span style="color: #BCBCBC;">2</span> setosa </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>  -<span style="color: #BB0000;">2.36</span> -<span style="color: #BB0000;">0.342</span> -<span style="color: #BB0000;">0.044</span><span style="color: #BB0000; text-decoration: underline;">2</span> ... | <span style="color: #BCBCBC;">3</span> setosa </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>  -<span style="color: #BB0000;">2.30</span> -<span style="color: #BB0000;">0.597</span> -<span style="color: #BB0000;">0.091</span><span style="color: #BB0000; text-decoration: underline;">3</span>     | <span style="color: #BCBCBC;">4</span> setosa </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>  -<span style="color: #BB0000;">2.39</span>  0.647 -<span style="color: #BB0000;">0.015</span><span style="color: #BB0000; text-decoration: underline;">7</span>     | <span style="color: #BCBCBC;">5</span> setosa </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 145 more rows</span>     | <span style="color: #949494;"># ℹ 145 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Columns (standard): [ 4 x 4 | 0 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Comp.1 Comp.2 Comp.3 ... | </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            | </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  0.521 0.377   0.720     | </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">0.269</span> 0.923  -<span style="color: #BB0000;">0.244</span> ... | </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>  0.580 0.024<span style="text-decoration: underline;">5</span> -<span style="color: #BB0000;">0.142</span>     | </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>  0.565 0.066<span style="text-decoration: underline;">9</span> -<span style="color: #BB0000;">0.634</span>     | </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># row-principal biplot with centroid-based stars</span></span></span>
<span class="r-in"><span><span class="va">iris_pca</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">scale_color_brewer</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"qual"</span>, palette <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">stat_rows_star</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span>, fun <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">stat_rows_center</span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggtitle</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"Row-principal PCA biplot of Anderson iris measurements"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Segments connect each observation to its within-species centroid"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-plt img"><img src="biplot-stats-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># row-principal biplot with depth median-based stars</span></span></span>
<span class="r-in"><span><span class="va">iris_pca</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">scale_color_brewer</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"qual"</span>, palette <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">stat_rows_star</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span>, fun.ord <span class="op">=</span> <span class="st">"depth_median"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">stat_rows_center</span><span class="op">(</span>fun.ord <span class="op">=</span> <span class="st">"depth_median"</span>, size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggtitle</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"Row-principal PCA biplot of Anderson iris measurements"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Segments connect each observation to its within-species depth median"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-plt img"><img src="biplot-stats-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># correspondence analysis of combined female and male hair and eye color data</span></span></span>
<span class="r-in"><span><span class="va">HairEyeColor</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/corresp.html" class="external-link">corresp</a></span><span class="op">(</span>nf <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tbl_ord.html">as_tbl_ord</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="augmentation.html">augment_ord</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">hec_ca</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # A tbl_ord of class 'correspondence': (4 x 2) x (4 x 2)'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # 2 coordinates: Can1 and Can2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Rows (standard): [ 4 x 2 | 1 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Can1   Can2 |   name </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 |   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">1.10</span>   1.44  | <span style="color: #BCBCBC;">1</span> Black</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">0.324</span> -<span style="color: #BB0000;">0.219</span> | <span style="color: #BCBCBC;">2</span> Brown</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.283</span> -<span style="color: #BB0000;">2.14</span>  | <span style="color: #BCBCBC;">3</span> Red  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>  1.83   0.467 | <span style="color: #BCBCBC;">4</span> Blond</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Columns (standard): [ 4 x 2 | 1 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Can1   Can2 |   name </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 |   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">1.08</span>   0.592 | <span style="color: #BCBCBC;">1</span> Brown</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>  1.20   0.556 | <span style="color: #BCBCBC;">2</span> Blue </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.465</span> -<span style="color: #BB0000;">1.12</span>  | <span style="color: #BCBCBC;">3</span> Hazel</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>  0.354 -<span style="color: #BB0000;">2.27</span>  | <span style="color: #BCBCBC;">4</span> Green</span>
<span class="r-in"><span><span class="co"># inertia across artificial coordinates (all singular values &lt; 1)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="recoverers.html">get_inertia</a></span><span class="op">(</span><span class="va">hec_ca</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Can1       Can2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.20877265 0.02222661 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># in row-principal biplot, row coordinates are weighted averages of columns</span></span></span>
<span class="r-in"><span><span class="va">hec_ca</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="conference.html">confer_inertia</a></span><span class="op">(</span><span class="st">"rows"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">.matrix</span>, fill <span class="op">=</span> <span class="va">.matrix</span>, shape <span class="op">=</span> <span class="va">.matrix</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">stat_cols_chull</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_cols_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Row-principal CA of hair &amp; eye color"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="biplot-stats-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># in column-principal biplot, column coordinates are weighted averages of rows</span></span></span>
<span class="r-in"><span><span class="va">hec_ca</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="conference.html">confer_inertia</a></span><span class="op">(</span><span class="st">"cols"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">.matrix</span>, fill <span class="op">=</span> <span class="va">.matrix</span>, shape <span class="op">=</span> <span class="va">.matrix</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">stat_rows_chull</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_cols_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Column-principal CA of hair &amp; eye color"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="biplot-stats-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># centered principal components analysis of U.S. personal expenditure data</span></span></span>
<span class="r-in"><span><span class="va">USPersonalExpenditure</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tbl_ord.html">as_tbl_ord</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="augmentation.html">augment_ord</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="co"># allow radiating text to exceed plotting window</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, clip <span class="op">=</span> <span class="st">"off"</span>,</span></span>
<span class="r-in"><span>           sec.axes <span class="op">=</span> <span class="st">"cols"</span>, scale.factor <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_label</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="co"># omit labels in the conical hull without the origin</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_cols_vector</a></span><span class="op">(</span>vector_labels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">stat_cols_cone</span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_cols_vector</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"cone"</span>, vector_labels <span class="op">=</span> <span class="cn">TRUE</span>, color <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggtitle</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"U.S. Personal Expenditure data, 1940-1960"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Row-principal biplot of centered PCA"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-plt img"><img src="biplot-stats-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># compute row-principal components of scaled iris measurements</span></span></span>
<span class="r-in"><span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tbl_ord.html">as_tbl_ord</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="dplyr-verbs.html">mutate_rows</a></span><span class="op">(</span>species <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">iris_pca</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # A tbl_ord of class 'prcomp': (150 x 4) x (4 x 4)'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # 4 coordinates: PC1, PC2, ..., PC4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Rows (principal): [ 150 x 4 | 1 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     PC1    PC2     PC3 ... |   species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            |   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">2.26</span> -<span style="color: #BB0000;">0.478</span>  0.127      | <span style="color: #BCBCBC;">1</span> setosa </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">2.07</span>  0.672  0.234      | <span style="color: #BCBCBC;">2</span> setosa </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">2.36</span>  0.341 -<span style="color: #BB0000;">0.044</span><span style="color: #BB0000; text-decoration: underline;">1</span> ... | <span style="color: #BCBCBC;">3</span> setosa </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> -<span style="color: #BB0000;">2.29</span>  0.595 -<span style="color: #BB0000;">0.091</span><span style="color: #BB0000; text-decoration: underline;">0</span>     | <span style="color: #BCBCBC;">4</span> setosa </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> -<span style="color: #BB0000;">2.38</span> -<span style="color: #BB0000;">0.645</span> -<span style="color: #BB0000;">0.015</span><span style="color: #BB0000; text-decoration: underline;">7</span>     | <span style="color: #BCBCBC;">5</span> setosa </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 145 more rows</span>     | <span style="color: #949494;"># ℹ 145 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Columns (standard): [ 4 x 4 | 0 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      PC1     PC2    PC3 ... | </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             | </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  0.521 -<span style="color: #BB0000;">0.377</span>   0.720     | </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">0.269</span> -<span style="color: #BB0000;">0.923</span>  -<span style="color: #BB0000;">0.244</span> ... | </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>  0.580 -<span style="color: #BB0000;">0.024</span><span style="color: #BB0000; text-decoration: underline;">5</span> -<span style="color: #BB0000;">0.142</span>     | </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>  0.565 -<span style="color: #BB0000;">0.066</span><span style="color: #BB0000; text-decoration: underline;">9</span> -<span style="color: #BB0000;">0.634</span>     | </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># row-principal biplot with centroids and confidence elliptical disks</span></span></span>
<span class="r-in"><span><span class="va">iris_pca</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">geom_polygon</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    color <span class="op">=</span> <span class="cn">NA</span>, alpha <span class="op">=</span> <span class="fl">.25</span>, stat <span class="op">=</span> <span class="st">"rows_ellipse"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_cols_vector</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#444444"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">scale_color_brewer</span><span class="op">(</span></span></span>
<span class="r-in"><span>    type <span class="op">=</span> <span class="st">"qual"</span>, palette <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    aesthetics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"color"</span>, <span class="st">"fill"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggtitle</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"Row-principal PCA biplot of Anderson iris measurements"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Overlaid with 95% confidence disks"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-plt img"><img src="biplot-stats-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">judge_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="ordinate.html">ordinate</a></span><span class="op">(</span><span class="va">USJudgeRatings</span>, <span class="va">princomp</span>, cols <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="va">judge_pca</span>, axis.type <span class="op">=</span> <span class="st">"predictive"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_cols_axis</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span>elements <span class="op">=</span> <span class="st">"score"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">stat_rows_peel</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">aes</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">hull</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, elements <span class="op">=</span> <span class="st">"score"</span>,</span></span>
<span class="r-in"><span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.9</span>, <span class="fl">.5</span>, <span class="fl">.1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Using alpha for a discrete variable is not advised.</span>
<span class="r-plt img"><img src="biplot-stats-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="va">judge_pca</span>, axis.type <span class="op">=</span> <span class="st">"predictive"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_cols_axis</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span>elements <span class="op">=</span> <span class="st">"score"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">stat_rows_peel</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">aes</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">hull</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, elements <span class="op">=</span> <span class="st">"score"</span>,</span></span>
<span class="r-in"><span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.9</span>, <span class="fl">.5</span>, <span class="fl">.1</span><span class="op">)</span>, cut <span class="op">=</span> <span class="st">"below"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Using alpha for a discrete variable is not advised.</span>
<span class="r-plt img"><img src="biplot-stats-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">iris_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="ordinate.html">ordinate</a></span><span class="op">(</span><span class="va">iris</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, model <span class="op">=</span> <span class="va">prcomp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="va">iris_pca</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>, shape <span class="op">=</span> <span class="st">"circle open"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">stat_rows_peel</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Species</span>, alpha <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">hull</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    num <span class="op">=</span> <span class="fl">3</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Using alpha for a discrete variable is not advised.</span>
<span class="r-plt img"><img src="biplot-stats-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># unscaled PCA</span></span></span>
<span class="r-in"><span><span class="va">iris_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="ordinate.html">ordinate</a></span><span class="op">(</span><span class="va">iris</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, model <span class="op">=</span> <span class="va">prcomp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># biplot canvas</span></span></span>
<span class="r-in"><span><span class="va">iris_biplot</span> <span class="op">&lt;-</span> </span></span>
<span class="r-in"><span>  <span class="va">iris_pca</span> <span class="op">|&gt;</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">Species</span>, label <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, axis.type <span class="op">=</span> <span class="st">"predictive"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_cols_axis</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>center <span class="op">=</span> <span class="va">center</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># print select cases</span></span></span>
<span class="r-in"><span><span class="va">top_cases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">51</span>, <span class="fl">101</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">iris</span><span class="op">[</span><span class="va">top_cases</span>, <span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            5.1         3.5          1.4         0.2     setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51           7.0         3.2          4.7         1.4 versicolor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101          6.3         3.3          6.0         2.5  virginica</span>
<span class="r-in"><span><span class="co"># subset variables</span></span></span>
<span class="r-in"><span><span class="va">length_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">iris</span><span class="op">[</span>, <span class="va">length_vars</span><span class="op">]</span> <span class="op">|&gt;</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span>by <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>, <span class="st">"Species"</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Species Sepal.Length Petal.Length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     setosa        5.006        1.462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 versicolor        5.936        4.260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  virginica        6.588        5.552</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># project all cases onto all axes</span></span></span>
<span class="r-in"><span><span class="va">iris_biplot</span> <span class="op">+</span> <span class="fu">stat_rows_projection</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="biplot-stats-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># project all cases onto select axes</span></span></span>
<span class="r-in"><span><span class="va">iris_biplot</span> <span class="op">+</span> <span class="fu">stat_rows_projection</span><span class="op">(</span>ref_subset <span class="op">=</span> <span class="va">length_vars</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `subset` will be applied after data are restricted to active elements.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #555555;">This message is displayed once per session.</span></span>
<span class="r-plt img"><img src="biplot-stats-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># project select cases onto all axes</span></span></span>
<span class="r-in"><span><span class="va">iris_biplot</span> <span class="op">+</span> <span class="fu">stat_rows_projection</span><span class="op">(</span>subset <span class="op">=</span> <span class="va">top_cases</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="biplot-stats-15.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># project select cases onto select axes</span></span></span>
<span class="r-in"><span><span class="va">iris_biplot</span> <span class="op">+</span> <span class="fu">stat_rows_projection</span><span class="op">(</span>subset <span class="op">=</span> <span class="va">top_cases</span>, ref_subset <span class="op">=</span> <span class="va">length_vars</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="biplot-stats-16.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># project select cases onto manually provided axes</span></span></span>
<span class="r-in"><span><span class="va">iris_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="recoverers.html">get_cols</a></span><span class="op">(</span><span class="va">iris_pca</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">iris_biplot</span> <span class="op">+</span> <span class="fu">stat_rows_projection</span><span class="op">(</span>subset <span class="op">=</span> <span class="va">top_cases</span>, referent <span class="op">=</span> <span class="va">iris_cols</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="biplot-stats-17.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># project selected cases onto selected axes in full-dimensional space</span></span></span>
<span class="r-in"><span><span class="va">iris_pca</span> <span class="op">|&gt;</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="fu"><a href="ggbiplot.html">ord_aes</a></span><span class="op">(</span><span class="va">iris_pca</span>, color <span class="op">=</span> <span class="va">Species</span>, label <span class="op">=</span> <span class="va">name</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           axis.type <span class="op">=</span> <span class="st">"predictive"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_cols_axis</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>center <span class="op">=</span> <span class="va">center</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">stat_rows_projection</span><span class="op">(</span>subset <span class="op">=</span> <span class="va">top_cases</span>, ref_subset <span class="op">=</span> <span class="va">length_vars</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="biplot-stats-18.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Freestone primary glass measurements</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">glass</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 68 × 16</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Site      Anal  Context Form   SiO2  TiO2 Al2O3   FeO   MnO   MgO   CaO  Na2O</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> Bet Eli'… 1     L14.B1… Chunk  76.0 <span style="color: #BB0000;">NA</span>     3.29  0.45   0.1  0.57  5.96  12.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> Bet Eli'… 2     L14.B1… Chunk  73.6  0.16  3.7   0.85  <span style="color: #BB0000;">NA</span>    0.68  6.65  13.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> Bet Eli'… 3     L14.B1… Chunk  75.0  0.13  3.36  0.53  <span style="color: #BB0000;">NA</span>    0.58  7.27  11.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> Bet Eli'… 4     L14.B1… Chunk  76.0 <span style="color: #BB0000;">NA</span>     3.06  0.35   0.1  0.61  7.63  11.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> Bet Eli'… 5     L14.B1… Chunk  75.9 <span style="color: #BB0000;">NA</span>     3.13  0.33  <span style="color: #BB0000;">NA</span>    0.65  7.49  11.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> Bet Eli'… 6     L14.B1… Chunk  74.4  0.14  3.33  0.45  <span style="color: #BB0000;">NA</span>    0.62  7.2   12.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> Bet Eli'… 29    L31.B3… Chunk  75.8  0.09  3.27  0.52  <span style="color: #BB0000;">NA</span>    0.64  6.52  11.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> Bet Eli'… 30    L31.B3… Chunk  73.4  0.11  3.5   0.68  <span style="color: #BB0000;">NA</span>    0.58  7.73  12.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> Bet Eli'… 31    L31.B3… Chunk  75.2  0.11  3.39  0.49  <span style="color: #BB0000;">NA</span>    0.53  7.28  11.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> Bet Eli'… 32    L31.B3… Chunk  73.7  0.16  3.42  0.53  <span style="color: #BB0000;">NA</span>    0.6   7.7   12.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 58 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 4 more variables: K2O &lt;dbl&gt;, P2O5 &lt;dbl&gt;, Cl &lt;dbl&gt;, SO3 &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># default (standardized) linear discriminant analysis of sites on measurements</span></span></span>
<span class="r-in"><span><span class="va">glass_lda</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lda.html" class="external-link">lda</a></span><span class="op">(</span><span class="va">Site</span> <span class="op">~</span> <span class="va">SiO2</span> <span class="op">+</span> <span class="va">Al2O3</span> <span class="op">+</span> <span class="va">FeO</span> <span class="op">+</span> <span class="va">MgO</span> <span class="op">+</span> <span class="va">CaO</span>, <span class="va">glass</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># bestow 'tbl_ord' class &amp; augment observation, centroid, and variable fields</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tbl_ord.html">as_tbl_ord</a></span><span class="op">(</span><span class="va">glass_lda</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="augmentation.html">augment_ord</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">glass_lda</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # A tbl_ord of class 'lda': (72 x 3) x (5 x 3)'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # 3 coordinates: LD1, LD2, LD3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Rows (principal): [ 72 x 3 | 5 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     LD1    LD2      LD3 |   name         prior counts grouping</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         |   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  1.82 -<span style="color: #BB0000;">1.21</span>  -<span style="color: #BB0000;">0.672</span>   | <span style="color: #BCBCBC;">1</span> Apollonia    0.132      9 Apollon…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">5.62</span>  0.364 -<span style="color: #BB0000;">0.003</span><span style="color: #BB0000; text-decoration: underline;">98</span> | <span style="color: #BCBCBC;">2</span> Banias       0.265     18 Banias  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>  2.47  1.63   0.083<span style="text-decoration: underline;">3</span>  | <span style="color: #BCBCBC;">3</span> Bet Eli'ez…  0.397     27 Bet Eli…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>  1.31 -<span style="color: #BB0000;">2.84</span>   0.277   | <span style="color: #BCBCBC;">4</span> Dor          0.206     14 Dor     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>  2.99  2.03  -<span style="color: #BB0000;">1.22</span>    | <span style="color: #BCBCBC;">5</span> 1           <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> Bet Eli…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 67 more rows</span> | <span style="color: #949494;"># ℹ 67 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: .element &lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Columns (standard): [ 5 x 3 | 2 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        LD1    LD2    LD3 |   name  .element</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          |   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  0.006<span style="text-decoration: underline;">81</span> 0.618   0.468 | <span style="color: #BCBCBC;">1</span> SiO2  active  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>  2.05    1.04   -<span style="color: #BB0000;">0.660</span> | <span style="color: #BCBCBC;">2</span> Al2O3 active  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">1.93</span>    0.165   2.44  | <span style="color: #BCBCBC;">3</span> FeO   active  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> -<span style="color: #BB0000;">1.76</span>    1.82   -<span style="color: #BB0000;">0.599</span> | <span style="color: #BCBCBC;">4</span> MgO   active  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> -<span style="color: #BB0000;">0.275</span>   0.094<span style="text-decoration: underline;">2</span>  1.42  | <span style="color: #BCBCBC;">5</span> CaO   active  </span>
<span class="r-in"><span><span class="co"># row-standard biplot</span></span></span>
<span class="r-in"><span><span class="va">glass_lda</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="conference.html">confer_inertia</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>shape <span class="op">=</span> <span class="va">grouping</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="theme_scaffold.html">theme_biplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span>elements <span class="op">=</span> <span class="st">"score"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">stat_cols_rule</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#888888"</span>, num <span class="op">=</span> <span class="fl">8L</span>,</span></span>
<span class="r-in"><span>    ref_elements <span class="op">=</span> <span class="st">"score"</span>, fun.offset <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">minabspp</span><span class="op">(</span><span class="va">x</span>, p <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    text.size <span class="op">=</span> <span class="fl">2.5</span>, label_dodge <span class="op">=</span> <span class="fl">.04</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">scale_shape_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">3L</span>, <span class="fl">0L</span>, <span class="fl">5L</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggtitle</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"LDA of Freestone glass measurements"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Row-standard biplot of standardized LDA"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Computation failed in `stat_cols_rule()`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Caused by error in `minabspp()`:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> could not find function "minabspp"</span>
<span class="r-plt img"><img src="biplot-stats-19.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># contribution LDA of sites on measurements</span></span></span>
<span class="r-in"><span><span class="va">glass_lda</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="lda-ord.html">lda_ord</a></span><span class="op">(</span><span class="va">Site</span> <span class="op">~</span> <span class="va">SiO2</span> <span class="op">+</span> <span class="va">Al2O3</span> <span class="op">+</span> <span class="va">FeO</span> <span class="op">+</span> <span class="va">MgO</span> <span class="op">+</span> <span class="va">CaO</span>, <span class="va">glass</span>,</span></span>
<span class="r-in"><span>          axes.scale <span class="op">=</span> <span class="st">"contribution"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># bestow 'tbl_ord' class &amp; augment observation, centroid, and variable fields</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tbl_ord.html">as_tbl_ord</a></span><span class="op">(</span><span class="va">glass_lda</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="augmentation.html">augment_ord</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">glass_lda</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # A tbl_ord of class 'lda_ord': (72 x 3) x (5 x 3)'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # 3 coordinates: LD1, LD2, LD3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Rows (principal): [ 72 x 3 | 5 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     LD1    LD2      LD3 |   name         prior counts grouping</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         |   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  1.82 -<span style="color: #BB0000;">1.21</span>  -<span style="color: #BB0000;">0.672</span>   | <span style="color: #BCBCBC;">1</span> Apollonia    0.132      9 Apollon…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">5.62</span>  0.364 -<span style="color: #BB0000;">0.003</span><span style="color: #BB0000; text-decoration: underline;">98</span> | <span style="color: #BCBCBC;">2</span> Banias       0.265     18 Banias  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>  2.47  1.63   0.083<span style="text-decoration: underline;">3</span>  | <span style="color: #BCBCBC;">3</span> Bet Eli'ez…  0.397     27 Bet Eli…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>  1.31 -<span style="color: #BB0000;">2.84</span>   0.277   | <span style="color: #BCBCBC;">4</span> Dor          0.206     14 Dor     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>  2.99  2.03  -<span style="color: #BB0000;">1.22</span>    | <span style="color: #BCBCBC;">5</span> 1           <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> Bet Eli…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 67 more rows</span> | <span style="color: #949494;"># ℹ 67 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: .element &lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Columns (standard): [ 5 x 3 | 2 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LD1    LD2     LD3 |   name  .element</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          |   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  0.166   0.871  0.160  | <span style="color: #BCBCBC;">1</span> SiO2  active  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>  0.663   0.164  0.044<span style="text-decoration: underline;">2</span> | <span style="color: #BCBCBC;">2</span> Al2O3 active  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.142</span>   0.112  0.192  | <span style="color: #BCBCBC;">3</span> FeO   active  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> -<span style="color: #BB0000;">0.680</span>   0.367 -<span style="color: #BB0000;">0.069</span><span style="color: #BB0000; text-decoration: underline;">4</span> | <span style="color: #BCBCBC;">4</span> MgO   active  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> -<span style="color: #BB0000;">0.080</span><span style="color: #BB0000; text-decoration: underline;">4</span> -<span style="color: #BB0000;">0.151</span>  0.941  | <span style="color: #BCBCBC;">5</span> CaO   active  </span>
<span class="r-in"><span><span class="co"># symmetric biplot</span></span></span>
<span class="r-in"><span><span class="va">glass_lda</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="conference.html">confer_inertia</a></span><span class="op">(</span><span class="fl">.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>shape <span class="op">=</span> <span class="va">grouping</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="theme_scaffold.html">theme_biplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_rows_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">stat_rows_density_2d</span><span class="op">(</span>elements <span class="op">=</span> <span class="st">"score"</span>, alpha <span class="op">=</span> <span class="fl">.5</span>, color <span class="op">=</span> <span class="st">"#444444"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">stat_cols_rule</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, geom <span class="op">=</span> <span class="st">"axis"</span>, color <span class="op">=</span> <span class="st">"#888888"</span>, num <span class="op">=</span> <span class="fl">8L</span>,</span></span>
<span class="r-in"><span>    ref_elements <span class="op">=</span> <span class="st">"active"</span>, fun.offset <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">minabspp</span><span class="op">(</span><span class="va">x</span>, p <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    label_dodge <span class="op">=</span> <span class="fl">0.04</span>, text.size <span class="op">=</span> <span class="fl">2.5</span>, text_dodge <span class="op">=</span> <span class="fl">.025</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">scale_shape_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16L</span>, <span class="fl">17L</span>, <span class="fl">15L</span>, <span class="fl">18L</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggtitle</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"LDA of Freestone glass measurements"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Symmetric biplot of contribution LDA"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Computation failed in `stat_cols_rule()`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Caused by error in `minabspp()`:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> could not find function "minabspp"</span>
<span class="r-plt img"><img src="biplot-stats-20.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># classical multidimensional scaling of road distances between European cities</span></span></span>
<span class="r-in"><span><span class="va">euro_mds</span> <span class="op">&lt;-</span> <span class="fu"><a href="ordinate.html">ordinate</a></span><span class="op">(</span><span class="va">eurodist</span>, <span class="va">cmdscale_ord</span>, k <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># monoplot of city locations</span></span></span>
<span class="r-in"><span><span class="va">euro_plot</span> <span class="op">&lt;-</span> <span class="va">euro_mds</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="negation.html">negate_ord</a></span><span class="op">(</span><span class="st">"PCo2"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="biplot-geoms.html">geom_cols_text</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">euro_plot</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># biplot with minimal spanning tree based on plotting window distances</span></span></span>
<span class="r-in"><span><span class="va">euro_plot</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">stat_cols_spantree</span><span class="op">(</span></span></span>
<span class="r-in"><span>    engine <span class="op">=</span> <span class="st">"mlpack"</span>,</span></span>
<span class="r-in"><span>    alpha <span class="op">=</span> <span class="fl">.5</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># biplot with minimal spanning tree based on full-dimensional distances</span></span></span>
<span class="r-in"><span><span class="va">euro_plot</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">stat_cols_spantree</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="ggbiplot.html">ord_aes</a></span><span class="op">(</span><span class="va">euro_mds</span><span class="op">)</span>, engine <span class="op">=</span> <span class="st">"mlpack"</span>,</span></span>
<span class="r-in"><span>    alpha <span class="op">=</span> <span class="fl">.5</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jason Cory Brunson, John Gracey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

