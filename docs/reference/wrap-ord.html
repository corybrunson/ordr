<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Wrappers for lossy ordination methods — wrap-ord • ordr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Wrappers for lossy ordination methods — wrap-ord"><meta property="og:description" content="These *_ord functions wrap core R functions with modifications
for use with 'tbl_ord' methods. Some parameters are hidden from the user
and set to settings required for these methods, some matrix outputs are
given row or column names to be used by them, and new '*_ord' S3 class
attributes are added to enable them."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ordr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1.0002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/ordr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/cmds-variables.html">multidimensional scaling of variables</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/corybrunson/ordr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Wrappers for lossy ordination methods</h1>
    <small class="dont-index">Source: <a href="https://github.com/corybrunson/ordr/blob/HEAD/R/fun-wrap.r" class="external-link"><code>R/fun-wrap.r</code></a></small>
    <div class="hidden name"><code>wrap-ord.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These <code>*_ord</code> functions wrap core R functions with modifications
for use with '<a href="tbl_ord.html">tbl_ord</a>' methods. Some parameters are hidden from the user
and set to settings required for these methods, some matrix outputs are
given row or column names to be used by them, and new '*_ord' S3 class
attributes are added to enable them.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eigen_ord</span><span class="op">(</span><span class="va">x</span>, symmetric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/isSymmetric.html" class="external-link">isSymmetric.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">svd_ord</span><span class="op">(</span><span class="va">x</span>, nu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, nv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cmdscale_ord</span><span class="op">(</span><span class="va">d</span>, k <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cancor_ord</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, xcenter <span class="op">=</span> <span class="cn">TRUE</span>, ycenter <span class="op">=</span> <span class="cn">TRUE</span>, scores <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a numeric or complex matrix whose spectral decomposition is to
    be computed.  Logical matrices are coerced to numeric.</p></dd>


<dt id="arg-symmetric">symmetric<a class="anchor" aria-label="anchor" href="#arg-symmetric"></a></dt>
<dd><p>if <code>TRUE</code>, the matrix is assumed to be symmetric
    (or Hermitian if complex) and only its lower triangle (diagonal
    included) is used.  If <code>symmetric</code> is not specified,
    <code><a href="https://rdrr.io/r/base/isSymmetric.html" class="external-link">isSymmetric</a>(x)</code> is used.</p></dd>


<dt id="arg-nu">nu<a class="anchor" aria-label="anchor" href="#arg-nu"></a></dt>
<dd><p>the number of left  singular vectors to be computed.
    This must between <code>0</code> and <code>n = nrow(x)</code>.</p></dd>


<dt id="arg-nv">nv<a class="anchor" aria-label="anchor" href="#arg-nv"></a></dt>
<dd><p>the number of right singular vectors to be computed.
    This must be between <code>0</code> and <code>p = ncol(x)</code>.</p></dd>


<dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>a distance structure such as that returned by <code>dist</code>
    or a full symmetric matrix containing the dissimilarities.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>the maximum dimension of the space which the data are to be
    represented in; must be in \(\{1, 2, \ldots, n-1\}\).</p></dd>


<dt id="arg-add">add<a class="anchor" aria-label="anchor" href="#arg-add"></a></dt>
<dd><p>logical indicating if an additive constant \(c*\) should
    be computed, and added to the non-diagonal dissimilarities such that
    the modified dissimilarities are Euclidean.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>numeric matrix (\(n \times p_2\)), containing the
    y coordinates.</p></dd>


<dt id="arg-xcenter">xcenter<a class="anchor" aria-label="anchor" href="#arg-xcenter"></a></dt>
<dd><p>logical or numeric vector of length \(p_1\),
    describing any centering to be done on the x values before the
    analysis.  If <code>TRUE</code> (default), subtract the column means.
    If <code>FALSE</code>, do not adjust the columns.  Otherwise, a vector
    of values to be subtracted from the columns.</p></dd>


<dt id="arg-ycenter">ycenter<a class="anchor" aria-label="anchor" href="#arg-ycenter"></a></dt>
<dd><p>analogous to <code>xcenter</code>, but for the y values.</p></dd>


<dt id="arg-scores">scores<a class="anchor" aria-label="anchor" href="#arg-scores"></a></dt>
<dd><p>Logical; whether to return canonical scores and structure
correlations.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Objects slightly modified from the outputs of the original functions,
with new '*-ord' classes.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The following table summarizes the wrapped functions:</p><table class="table table"><tr><td>Original function</td><td>Hide params</td><td>New params</td><td>Add names</td><td>New class</td></tr><tr><td><code><a href="https://rdrr.io/r/base/eigen.html" class="external-link">base::eigen()</a></code></td><td>Yes</td><td>No</td><td>Yes</td><td>Yes</td></tr><tr><td><code><a href="https://rdrr.io/r/base/svd.html" class="external-link">base::svd()</a></code></td><td>Yes</td><td>No</td><td>Yes</td><td>Yes</td></tr><tr><td><code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">stats::cmdscale()</a></code></td><td>Yes</td><td>No</td><td>No</td><td>Yes</td></tr><tr><td><code><a href="https://rdrr.io/r/stats/cancor.html" class="external-link">stats::cancor()</a></code></td><td>No</td><td>Yes</td><td>No</td><td>Yes</td></tr></table><p>By default, <code>cancor_ord()</code> returns the same data as <code><a href="https://rdrr.io/r/stats/cancor.html" class="external-link">stats::cancor()</a></code>: the
canonical correlations (<code>cor</code>), the canonical coefficients (<code>$xcoef</code> and
<code>$ycoef</code>), and the variable means (<code>$xcenter</code>, <code>$ycenter</code>). If <code>scores = TRUE</code>, then <code>cancor_ord()</code> also returns the scores <code>$xscores</code> and <code>$yscores</code>
calculated from the (appropriately centered) data and the coefficients and
the intraset structure correlations <code>$xstructure</code> and <code>$ystructure</code> between
these and the data. These modifications are inspired by the <code><a href="https://rdrr.io/r/stats/cancor.html" class="external-link">cancor()</a></code>
function in <strong>candisc</strong>, though two caveats should be noted: First, the
canonical coefficients (hence the canonical scores) are scaled by \(n - 1\)
compared to these, though the intraset structure correlations are the same.
Second, the <em>interset</em> structure correlations are not returned, as these may
be obtained by conferring inertia unto the intraset ones.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># glass composition data from one furnace</span></span></span>
<span class="r-in"><span><span class="va">glass_banias</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">glass</span>,</span></span>
<span class="r-in"><span>  <span class="va">Context</span> <span class="op">==</span> <span class="st">"L.15;B.166"</span>,</span></span>
<span class="r-in"><span>  select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SiO2"</span>, <span class="st">"Na2O"</span>, <span class="st">"CaO"</span>, <span class="st">"Al2O3"</span>, <span class="st">"MgO"</span>, <span class="st">"K2O"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># eigendecomposition of a covariance matrix</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">glass_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">glass_banias</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             SiO2       Na2O        CaO    Al2O3         MgO      K2O</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SiO2   2.6155367  0.6093667 -1.2869867 -0.45252 -0.46817333 -0.31149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Na2O   0.6093667  0.2559067 -0.3217067 -0.16542 -0.10587333 -0.10726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CaO   -1.2869867 -0.3217067  0.7060267  0.24842  0.20559333  0.13220</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Al2O3 -0.4525200 -0.1654200  0.2484200  0.12716  0.07972000  0.07230</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MgO   -0.4681733 -0.1058733  0.2055933  0.07972  0.09462667  0.06682</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K2O   -0.3114900 -0.1072600  0.1322000  0.07230  0.06682000  0.06131</span>
<span class="r-in"><span><span class="fu">eigen_ord</span><span class="op">(</span><span class="va">glass_cov</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eigen() decomposition</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.617285e+00 1.467376e-01 8.282650e-02 1.360291e-02 1.141672e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] 4.279624e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $vectors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              EV1         EV2         EV3         EV4        EV5        EV6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SiO2   0.8469970  0.31716695 -0.25837288 -0.11577441  0.2822267  0.1489597</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Na2O   0.2099520 -0.79170694 -0.10021025 -0.51787194 -0.1385212  0.1780413</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CaO   -0.4260986  0.04199369 -0.76882445 -0.05663831  0.3233201  0.3432808</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Al2O3 -0.1556273  0.45906193 -0.08066526 -0.77062798 -0.2878426 -0.2860325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MgO   -0.1492104 -0.07286372  0.38010592 -0.30504020  0.8407925 -0.1672273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K2O   -0.1023356  0.23408287  0.42558539 -0.16816668 -0.0826960  0.8476385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># singular value decomposition of a data matrix</span></span></span>
<span class="r-in"><span><span class="fu">svd_ord</span><span class="op">(</span><span class="va">glass_banias</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 177.16843535   2.56375788   0.82468871   0.51400398   0.21898181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6]   0.01400983</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          SV1          SV2         SV3        SV4        SV5         SV6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -0.4114474  0.268953258  0.54464383 -0.4529219  0.4351102  0.25938230</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -0.4099492  0.124966122  0.51481370  0.3162816 -0.6000110 -0.30206743</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.4097327 -0.103523503 -0.13351247  0.5115444  0.6162163 -0.40271096</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -0.3914429 -0.815275824 -0.07487103 -0.3907913 -0.1362392 -0.07220201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -0.4168814  0.486413365 -0.59131457 -0.3710452 -0.1857274 -0.26036475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 -0.4095779 -0.007607042 -0.25543255  0.3778329 -0.1337444  0.77865078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $v</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               SV1         SV2         SV3          SV4         SV5         SV6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SiO2  -0.97757835  0.09992541 -0.16303444  0.046753453 -0.05969843 -0.04500518</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Na2O  -0.16869103  0.14528933  0.81605152 -0.238508341  0.42108755  0.22426170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CaO   -0.11569079 -0.87296399  0.28883998  0.323881874 -0.16853953  0.08840776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Al2O3 -0.01665686 -0.29609746 -0.38102381  0.008014293  0.87323378 -0.06533172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MgO   -0.03775856 -0.28137368  0.06285458 -0.713218748 -0.10916969 -0.62837365</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K2O   -0.02822033 -0.19998734 -0.27371758 -0.572086712 -0.12751682  0.73535272</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "svd_ord"</span>
<span class="r-in"><span><span class="co"># classical multidimensional scaling of a distance matrix</span></span></span>
<span class="r-in"><span><span class="fu">cmdscale_ord</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">glass_banias</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $points</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.87986198  0.53544035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.45244074  0.40907498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.08144239 -0.26484655</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  3.61567304 -0.04227923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -1.99639680 -0.36657720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] -0.20553113 -0.27081236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eig</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.808643e+01 7.336881e-01 4.141325e-01 6.801456e-02 5.708361e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] 6.300478e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]        [,2]        [,3]        [,4]       [,5]         [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -2.207855556 -1.12728889  0.22354444   6.3455444 -3.2300556 -0.003888889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -1.127288889 -0.87692222  0.03611111   3.3851111 -1.3678889 -0.049122222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.223544444  0.03611111 -0.47385556   0.7213444 -0.2278556 -0.279288889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  6.345544444  3.38511111  0.72134444 -26.2322556 14.2529444  1.527311111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -3.230055556 -1.36788889 -0.22785556  14.2529444 -8.5234556 -0.903688889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] -0.003888889 -0.04912222 -0.27928889   1.5273111 -0.9036889 -0.291322222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ac</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $GOF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9749924 0.9749924</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "cmds_ord"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># canonical correlation analysis with trace components</span></span></span>
<span class="r-in"><span><span class="va">glass_banias_minor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">glass</span>,</span></span>
<span class="r-in"><span>  <span class="va">Context</span> <span class="op">==</span> <span class="st">"L.15;B.166"</span>,</span></span>
<span class="r-in"><span>  select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TiO2"</span>, <span class="st">"FeO"</span>, <span class="st">"MnO"</span>, <span class="st">"P2O5"</span>, <span class="st">"Cl"</span>, <span class="st">"SO3"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># impute half of detection threshold</span></span></span>
<span class="r-in"><span><span class="va">glass_banias_minor</span><span class="op">$</span><span class="va">TiO2</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="fu">cancor_ord</span><span class="op">(</span><span class="va">glass_banias</span>, <span class="va">glass_banias_minor</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $xcoef</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]      [,3]      [,4]      [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SiO2  -2.296248 -11.369291 -2.825844 -1.997054 -2.879401</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Na2O   1.035333   3.948798  1.016188  2.099571  2.843217</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CaO   -1.915708 -13.652940 -3.999884 -2.203852 -3.775547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Al2O3  1.133790  11.090690  4.050155  4.884709  4.535237</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MgO   -7.830795 -31.099321 -8.668147 -6.685554 -6.686017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ycoef</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]        [,3]       [,4]     [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TiO2  -3.214755  -2.257585   0.6077935  0.8226229 2.960014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FeO    6.509558  -1.818302  -3.6350924  2.2052729 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MnO    5.290203   2.278202  -3.6872234 -2.0749981 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P2O5 -14.417571 -17.411690   0.3602733 -4.7270262 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cl    25.883235   3.745439 -11.0966777 -7.1368602 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $xcenter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      SiO2      Na2O       CaO     Al2O3       MgO       K2O </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70.691667 12.196667  8.383333  1.210000  2.736667  2.045000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ycenter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      TiO2       FeO       MnO      P2O5        Cl       SO3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1933333 0.4300000 0.9666667 0.2700000 0.8100000 0.3483333 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "cancor_ord"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate canonical scores and structure correlations</span></span></span>
<span class="r-in"><span><span class="va">glass_cca</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">cancor_ord</span><span class="op">(</span><span class="va">glass_banias</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">glass_banias_minor</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, scores <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># scores</span></span></span>
<span class="r-in"><span><span class="va">glass_cca</span><span class="op">$</span><span class="va">xscores</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]         [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.08625757  0.564009626  0.5086737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.06325679  0.009686013  0.4449230</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.31243762 -0.589123478  0.1458326</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.85114073 -0.156299524 -0.2733283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.34697599  0.470284132 -0.6433738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] -0.21472789 -0.298556769 -0.1827271</span>
<span class="r-in"><span><span class="co"># intraset correlations</span></span></span>
<span class="r-in"><span><span class="va">glass_cca</span><span class="op">$</span><span class="va">xstructure</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SiO2 -0.9261925  0.3749912 0.03935800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Na2O -0.5467957  0.5715073 0.61187732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CaO   0.7639885 -0.6435255 0.04686735</span>
<span class="r-in"><span><span class="co"># interset correlations</span></span></span>
<span class="r-in"><span><span class="va">glass_cca</span><span class="op">$</span><span class="va">xstructure</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">glass_cca</span><span class="op">$</span><span class="va">cor</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SiO2 -0.9261925  0.3594308 0.02748688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Na2O -0.5467957  0.5477923 0.42732349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CaO   0.7639885 -0.6168220 0.03273126</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jason Cory Brunson, John Gracey.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

